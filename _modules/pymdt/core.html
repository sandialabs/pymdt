<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pymdt.core &mdash; PyMDT 1.4.2520 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=b081cfe2"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PyMDT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">pymdt</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyMDT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pymdt.core</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pymdt.core</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">pymdt.utils</span>
<span class="kn">import</span> <span class="nn">pymdt.specs</span>

<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="kn">import</span> <span class="nn">System</span>
<span class="kn">from</span> <span class="nn">System</span> <span class="kn">import</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">SYSEX</span>

<span class="kn">import</span> <span class="nn">MDT</span>
<span class="kn">import</span> <span class="nn">Common</span>

<div class="viewcode-block" id="controller_types">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.controller_types">[docs]</a>
<span class="k">class</span> <span class="nc">controller_types</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An enumeration of the types of microgrid controller available for</span>
<span class="sd">    selection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">Standard</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridControllerSettings</span><span class="o">.</span><span class="n">ControllerTypeEnum</span><span class="o">.</span><span class="n">Standard</span>    
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The Standard controller uses batteries as an energy source of last</span>
<span class="sd">    resort.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">CycleCharging</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridControllerSettings</span><span class="o">.</span><span class="n">ControllerTypeEnum</span><span class="o">.</span><span class="n">BatteryUser</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The CycleCharging controller uses batteries aggressively in an attempt</span>
<span class="sd">    to shave peaks and minimize diesel fuel usage.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

    
<div class="viewcode-block" id="powerflow_types">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.powerflow_types">[docs]</a>
<span class="k">class</span> <span class="nc">powerflow_types</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An enumeration of the possible powerflow calculations supported by</span>
<span class="sd">    the MDT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">NONE</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">MDT</span><span class="o">.</span><span class="n">PRMSettings</span><span class="o">.</span><span class="n">PowerflowTypeEnum</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Indicates that no powerflow calculations should be conducted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">DC</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRMSettings</span><span class="o">.</span><span class="n">PowerflowTypeEnum</span><span class="o">.</span><span class="n">DC</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Indicates that DC powerflow calculations should be conducted.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<span class="k">class</span> <span class="nc">details</span><span class="p">:</span>
    
    <span class="n">StoredLoadProfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">StoredSolarProfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">StoredWindProfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">StoredHydroProfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">StoredThermalProfiles</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_load_all_stored_configs</span><span class="p">(</span><span class="n">pth</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;*.msrd&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pth</span><span class="p">,</span> <span class="n">ext</span><span class="p">)):</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_set_node_location</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span><span class="nb">float</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">location</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">node</span><span class="p">,</span> <span class="s2">&quot;Location&quot;</span><span class="p">,</span> <span class="n">System</span><span class="o">.</span><span class="n">Drawing</span><span class="o">.</span><span class="n">PointF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_resolve_spec</span><span class="p">(</span><span class="n">specObj</span><span class="p">,</span> <span class="n">allSpecs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">FindEntityByName</span><span class="p">(</span><span class="n">allSpecs</span><span class="p">,</span> <span class="n">specObj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">specObj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">specObj</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_resolve_all_specs</span><span class="p">(</span><span class="n">specList</span><span class="p">,</span> <span class="n">allSpecs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">details</span><span class="o">.</span><span class="n">_resolve_spec</span><span class="p">(</span><span class="n">specObj</span><span class="p">,</span> <span class="n">allSpecs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
            <span class="k">for</span> <span class="n">specObj</span> <span class="ow">in</span> <span class="n">specList</span><span class="p">]</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_failure_distributions</span><span class="p">(</span><span class="n">fm</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FailureMode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">fm</span><span class="p">,</span> <span class="s2">&quot;MTBF&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_distribution</span><span class="p">(</span><span class="s2">&quot;mtbf&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">fm</span><span class="p">,</span> <span class="s2">&quot;MTTR&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_distribution</span><span class="p">(</span><span class="s2">&quot;mttr&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            
    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">_extract_fragilities</span><span class="p">(</span><span class="n">fragile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fcs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fragilities&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fcs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="c1"># The object obtained must be either a tuple or a dictionary.  If a</span>
        <span class="c1"># tuple, then it must be (Hazard, FragilityCurve)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fcs</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span> <span class="n">fcs</span> <span class="o">=</span> <span class="p">{</span><span class="n">fcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">fcs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">fcs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_2_arg_add_with_undo</span><span class="p">(</span>
                <span class="n">fragile</span><span class="p">,</span> <span class="s2">&quot;AddFragilityCurveCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_FragilityCurves&quot;</span><span class="p">,</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_specifications</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">all_specs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;base_spec&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">bSpec</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_resolve_spec</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;base_spec&quot;</span><span class="p">],</span> <span class="n">all_specs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">node</span><span class="p">,</span> <span class="s2">&quot;BaselineSpecification&quot;</span><span class="p">,</span> <span class="n">bSpec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;specs&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">specentry</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;specs&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_is_collection</span><span class="p">(</span><span class="n">specentry</span><span class="p">):</span>
                <span class="n">specentry</span> <span class="o">=</span> <span class="p">[</span><span class="n">specentry</span><span class="p">]</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_resolve_all_specs</span><span class="p">(</span><span class="n">specentry</span><span class="p">,</span> <span class="n">all_specs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">:</span>
                <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
                    <span class="n">node</span><span class="p">,</span> <span class="s2">&quot;AddSpecificationCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Specifications&quot;</span><span class="p">,</span>
                    <span class="n">spec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                    <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_node_location</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;loc&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_set_node_location</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_retrofit_cost</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">component</span><span class="p">,</span> <span class="s2">&quot;RetrofitCost&quot;</span><span class="p">,</span>
            <span class="n">System</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;retrofit_cost&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_tank</span><span class="p">(</span><span class="n">tank</span><span class="p">,</span> <span class="n">all_tanks</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tank</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">tank</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">FindEntityByName</span><span class="p">(</span><span class="n">all_tanks</span><span class="p">,</span> <span class="n">tank</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tank</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_fuel_tanks</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="n">all_tanks</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;tanks&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">tanks</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tanks&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_is_collection</span><span class="p">(</span><span class="n">tanks</span><span class="p">):</span> <span class="n">tanks</span> <span class="o">=</span> <span class="p">[</span><span class="n">tanks</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tanks</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
                <span class="n">gen</span><span class="p">,</span> <span class="s2">&quot;AddTankCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Tanks&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">.</span><span class="n">_extract_tank</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">all_tanks</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_resource</span><span class="p">(</span><span class="n">all_recs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resource&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">FindEntityByName</span><span class="p">(</span><span class="n">all_recs</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">rec</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_period_and_interval</span><span class="p">(</span><span class="n">rpd</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">IRegularPeriodData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># allow for the provision of some but not all values.  If all are found,</span>
        <span class="c1"># use SetPeriodAndInterval</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">int_units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;interval_units&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">time_units</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>
        <span class="n">period</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">per_units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;period_units&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">time_units</span><span class="o">.</span><span class="n">hours</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">int_units</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">):</span> <span class="n">int_units</span> <span class="o">=</span> <span class="n">int_units</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">per_units</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">):</span> <span class="n">per_units</span> <span class="o">=</span> <span class="n">per_units</span><span class="o">.</span><span class="n">value</span>
            
        <span class="c1"># Don&#39;t use kwargs.get to avoid creation of the UndoPack if not needed.</span>
        <span class="n">undos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;undos&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;undos&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">Common</span><span class="o">.</span><span class="n">Undoing</span><span class="o">.</span><span class="n">UndoPack</span><span class="p">()</span>

        <span class="n">rpd</span><span class="o">.</span><span class="n">SetPeriodAndInterval</span><span class="p">(</span>
            <span class="n">period</span><span class="p">,</span> <span class="n">per_units</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">int_units</span><span class="p">,</span> <span class="n">undos</span>
            <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_tier</span><span class="p">(</span><span class="n">ldwt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadTier</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tier&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">FindEntityByName</span><span class="p">(</span>
                <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">LoadTiers</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
                <span class="n">find_fail_behavior</span><span class="o">=</span><span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span><span class="p">,</span>
                <span class="n">find_context</span><span class="o">=</span><span class="s2">&quot;load tier master list&quot;</span>
                <span class="p">)</span>
            
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ldwt</span><span class="p">,</span> <span class="s2">&quot;LoadTier&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_owner</span><span class="p">(</span><span class="n">default_owner</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">,</span> <span class="n">default_owner</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRMMicrogridSettings</span><span class="p">:</span>
        <span class="n">prmSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_settings</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">prmSets</span><span class="o">.</span><span class="n">get_MicrogridSettings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_prm_settings</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRMSettings</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">PRMSettings</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_refueler_settings</span><span class="p">(</span><span class="n">refueler</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">refueler</span><span class="p">,</span> <span class="s2">&quot;RefuelingTimeOfDay&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;time_of_day&quot;</span><span class="p">,</span> <span class="n">refueler</span><span class="o">.</span><span class="n">RefuelingTimeOfDay</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">refueler</span><span class="p">,</span> <span class="s2">&quot;RefuelingPeriod&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">refueler</span><span class="o">.</span><span class="n">RefuelingPeriod</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">refueler</span><span class="p">,</span> <span class="s2">&quot;RefuelingQuantity&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="n">refueler</span><span class="o">.</span><span class="n">RefuelingQuantity</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_add_spec_find_args</span><span class="p">(</span><span class="n">context_lead_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_fail_behavior&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_lead_in</span> <span class="o">+</span> <span class="s2">&quot; specifications&quot;</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_line</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">sn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Line</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">name</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">MakeDefaultName</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">sn</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">l</span><span class="p">,</span> <span class="s2">&quot;FirstNode&quot;</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">l</span><span class="p">,</span> <span class="s2">&quot;SecondNode&quot;</span><span class="p">,</span> <span class="n">sn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">LineSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">l</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">l</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_diesel_tank</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselTank</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselTank</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;diesel tank&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">DieselTankSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;infinite_fuel&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_indexed_property_set</span><span class="p">(</span>
                <span class="n">mgSets</span><span class="p">,</span> <span class="s2">&quot;UseInfiniteDieselFuel&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;infinite_fuel&quot;</span><span class="p">],</span>
                <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_propane_tank</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneTank</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneTank</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;propane tank&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">PropaneTankSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;infinite_fuel&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_indexed_property_set</span><span class="p">(</span>
                <span class="n">mgSets</span><span class="p">,</span> <span class="s2">&quot;UseInfinitePropane&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;infinite_fuel&quot;</span><span class="p">],</span>
                <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_failure_mode</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FailureMode</span><span class="p">:</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FailureMode</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_distributions</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fm</span>
 
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_fragility_curve</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FragilityCurve</span><span class="p">:</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FragilityCurve</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">fc</span><span class="p">,</span> <span class="s2">&quot;MTTR&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_distribution</span><span class="p">(</span><span class="s2">&quot;mttr&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">fc</span><span class="p">,</span> <span class="s2">&quot;ProbabilityGenerator&quot;</span><span class="p">,</span> 
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_distribution</span><span class="p">(</span><span class="s2">&quot;probability_generator&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fc</span>
 
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_hazard</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Hazard</span><span class="p">:</span>
        <span class="n">haz</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Hazard</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">haz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">haz</span><span class="p">,</span> <span class="s2">&quot;IntensityGenerator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;intensity_generator&quot;</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">haz</span><span class="p">,</span> <span class="s2">&quot;Units&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">haz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">haz</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_design_basis_threat</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DesignBasisThreat</span><span class="p">:</span>
        <span class="n">dbt</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DesignBasisThreat</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">dbt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_distributions</span><span class="p">(</span><span class="n">dbt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">dbt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dbt</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_solar_generator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SolarGenerator</span><span class="p">:</span>
        <span class="n">sg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SolarGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;solar generator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">sg</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">SolarGeneratorSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;solar resources&quot;</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_resource</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">SolarResources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">sg</span><span class="p">,</span> <span class="s2">&quot;SolarResource&quot;</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">sg</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_wind_generator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">WindGenerator</span><span class="p">:</span>
        <span class="n">wg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">WindGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;wind generator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">wg</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">WindGeneratorSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">wg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;wind resources&quot;</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_resource</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">WindResources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>           
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">wg</span><span class="p">,</span> <span class="s2">&quot;WindResource&quot;</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">wg</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_hydro_generator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">HydroGenerator</span><span class="p">:</span>
        <span class="n">hg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">HydroGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;hydro generator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">hg</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">HydroGeneratorSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;hydro resources&quot;</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_resource</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">Site</span><span class="o">.</span><span class="n">HydroResources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">hg</span><span class="p">,</span> <span class="s2">&quot;HydroResource&quot;</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">hg</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_diesel_generator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselGenerator</span><span class="p">:</span>
        <span class="n">dg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;diesel generator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">dg</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">DieselGeneratorSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fuel_tanks</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">Microgrid</span><span class="o">.</span><span class="n">get_DieselTanks</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dg</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_propane_generator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneGenerator</span><span class="p">:</span>
        <span class="n">pg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;propane generator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">pg</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">PropaneGeneratorSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fuel_tanks</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">Microgrid</span><span class="o">.</span><span class="n">get_PropaneTanks</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pg</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_natural_gas_generator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">NaturalGasGenerator</span><span class="p">:</span>
        <span class="n">ngg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">NaturalGasGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;natural gas generator&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">ngg</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">NaturalGasGeneratorSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ngg</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_battery</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Battery</span><span class="p">:</span>
        <span class="n">bat</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Battery</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;battery&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">bat</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">BatterySpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bat</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_inverter</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Inverter</span><span class="p">:</span>
        <span class="n">inv</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Inverter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;inverter&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">inv</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">InverterSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inv</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_ups</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">UninterruptiblePowerSupply</span><span class="p">:</span>
        <span class="n">ups</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">UninterruptiblePowerSupply</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;UPS&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">ups</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">UninterruptiblePowerSupplySpecifications</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ups</span><span class="p">,</span> <span class="s2">&quot;LoadSection&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;load_section&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ups</span>
    
    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">build_load_section</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadSection</span><span class="p">:</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadSection</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_period_and_interval</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_voltage</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ls</span>

    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">build_load_tier</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadTier</span><span class="p">:</span>
        <span class="n">lt</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadTier</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">lt</span><span class="p">,</span> <span class="s2">&quot;Priority&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lt</span>

    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">build_tranformer</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Transformer</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Transformer</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;transformer&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">TransformerSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_bus</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_voltage</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">b</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_microgrid</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">:</span>
        <span class="n">mg</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mg</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_node_group_properties</span><span class="p">(</span><span class="n">ng</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">NodeGroup</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ng</span><span class="p">,</span> <span class="s2">&quot;Color&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_color</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ng</span><span class="p">,</span> <span class="s2">&quot;TextFont&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_font</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ng</span><span class="p">,</span> <span class="s2">&quot;Location&quot;</span><span class="p">,</span> <span class="n">System</span><span class="o">.</span><span class="n">Drawing</span><span class="o">.</span><span class="n">PointF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ng</span><span class="p">,</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">System</span><span class="o">.</span><span class="n">Drawing</span><span class="o">.</span><span class="n">SizeF</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ng</span><span class="p">,</span> <span class="s2">&quot;TextAlignment&quot;</span><span class="p">,</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_text_alignment</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_microgrid_node_group</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridNodeGroup</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridNodeGroup</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_group_properties</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_site_node_group</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SiteNodeGroup</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SiteNodeGroup</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_group_properties</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_node</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Node</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_voltage</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_switch</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Switch</span><span class="p">:</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Switch</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_node_location</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_add_spec_find_args</span><span class="p">(</span><span class="s2">&quot;switch&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_specifications</span><span class="p">(</span>
            <span class="n">sw</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">SwitchSpecifications</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_failure_modes</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_fragilities</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_retrofit_cost</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sw</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_stored_configuration</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">all_configs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;stored_configuration&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">stc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;stored_configuration&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">stc</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">stc</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_find_stored_config</span><span class="p">(</span>
            <span class="n">all_configs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;stored_configuration&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">stc</span><span class="o">.</span><span class="n">LoadConfigurationData</span><span class="p">()</span>        
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;StoredConfiguration&quot;</span><span class="p">,</span> <span class="n">stc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">stc</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_stored_configuration_or_data</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">all_configs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;stored_configuration&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_stored_configuration</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">all_configs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ResetRegularPeriodData</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_load_data_with_tier</span><span class="p">(</span><span class="n">lc</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">ILoadContainer</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadDataWithTier</span><span class="p">:</span>
        <span class="n">ldwt</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadDataWithTier</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">ldwt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_stored_configuration_or_data</span><span class="p">(</span>
            <span class="n">ldwt</span><span class="p">,</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredLoadProfiles</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_tier</span><span class="p">(</span><span class="n">ldwt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">ldwt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ldwt</span>
    
    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">build_microgrid_design_option</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridDesignOption</span><span class="p">:</span>
        <span class="n">mdo</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridDesignOption</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">mdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">mdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mdo</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_bus_design_option</span><span class="p">(</span><span class="n">mdo</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridDesignOption</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">BusDesignOption</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">MakeUsableName</span><span class="p">(</span><span class="n">mdo</span><span class="o">.</span><span class="n">Microgrid</span><span class="o">.</span><span class="n">AllBusses</span><span class="p">,</span> <span class="s2">&quot;Bus 1&quot;</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_bus</span><span class="p">(</span><span class="n">mdo</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">bdo</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">BusDesignOption</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">bdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">bdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bdo</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_solar_resource</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SolarResource</span><span class="p">:</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SolarResource</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;stored_configuration&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_fail_behavior&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fail_context=&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stored solar resource configurations&quot;</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_stored_configuration</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredSolarProfiles</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_period_and_interval</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ResetRegularPeriodData</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">sr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sr</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_wind_resource</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">WindResource</span><span class="p">:</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">WindResource</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">wr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;stored_configuration&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_fail_behavior&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fail_context=&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stored wind resource configurations&quot;</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_stored_configuration</span><span class="p">(</span><span class="n">wr</span><span class="p">,</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredWindProfiles</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_period_and_interval</span><span class="p">(</span><span class="n">wr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ResetRegularPeriodData</span><span class="p">(</span><span class="n">wr</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">wr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wr</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_hydro_resource</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">HydroResource</span><span class="p">:</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">HydroResource</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;stored_configuration&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;find_fail_behavior&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fail_context=&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stored hydro resource configurations&quot;</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_stored_configuration</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredHydroProfiles</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">details</span><span class="o">.</span><span class="n">_extract_period_and_interval</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ResetRegularPeriodData</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hr</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_find_stored_config</span><span class="p">(</span><span class="n">all_configs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">FindEntityByName</span><span class="p">(</span><span class="n">all_configs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_find_and_load_stored_config</span><span class="p">(</span><span class="n">all_configs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_find_stored_config</span><span class="p">(</span><span class="n">all_configs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">sc</span><span class="o">.</span><span class="n">LoadConfigurationData</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sc</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_stored_data_file</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>                
        <span class="n">fName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.msrd&quot;</span><span class="p">)</span>
        <span class="n">stDat</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">(</span><span class="n">fName</span><span class="p">)</span>    
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">stDat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">stDat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_tier</span><span class="p">(</span><span class="n">stDat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">int_units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;interval_units&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">time_units</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>
        <span class="n">per_units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;period_units&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">time_units</span><span class="o">.</span><span class="n">hours</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">int_units</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">):</span> <span class="n">int_units</span> <span class="o">=</span> <span class="n">int_units</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">per_units</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">):</span> <span class="n">per_units</span> <span class="o">=</span> <span class="n">per_units</span><span class="o">.</span><span class="n">value</span>

        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stDat</span><span class="p">,</span> <span class="s2">&quot;Interval&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stDat</span><span class="p">,</span> <span class="s2">&quot;IntervalUnits&quot;</span><span class="p">,</span> <span class="n">int_units</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stDat</span><span class="p">,</span> <span class="s2">&quot;Period&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stDat</span><span class="p">,</span> <span class="s2">&quot;PeriodUnits&quot;</span><span class="p">,</span> <span class="n">per_units</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">stDat</span><span class="p">,</span> <span class="s2">&quot;LoadData&quot;</span><span class="p">,</span>
                <span class="n">ResetRegularPeriodData</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>

        <span class="n">fStr</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">FileStream</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span> <span class="n">System</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">FileMode</span><span class="o">.</span><span class="n">Create</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="n">Runtime</span><span class="o">.</span><span class="n">Serialization</span><span class="o">.</span><span class="n">Formatters</span><span class="o">.</span><span class="n">Binary</span><span class="o">.</span><span class="n">BinaryFormatter</span><span class="p">()</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Binder</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">CustomSerializationBinder</span><span class="p">()</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="n">Common</span><span class="o">.</span><span class="n">Serialization</span><span class="o">.</span><span class="n">Archive</span><span class="p">(</span><span class="n">pymdt</span><span class="o">.</span><span class="n">MDT_VERSION</span><span class="p">)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">AddEmptyNode</span><span class="p">(</span><span class="n">stDat</span><span class="o">.</span><span class="n">GetType</span><span class="p">(),</span> <span class="n">stDat</span><span class="o">.</span><span class="n">GUID</span><span class="o">.</span><span class="n">ToString</span><span class="p">())</span>
        <span class="n">stDat</span><span class="o">.</span><span class="n">SaveConfigurationData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">ar</span><span class="o">.</span><span class="n">WriteFormatted</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">fStr</span><span class="p">)</span>
        <span class="n">fStr</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">stDat</span>
    
<span class="n">details</span><span class="o">.</span><span class="n">_load_all_stored_configs</span><span class="p">(</span>
    <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeLoadDataDirectory</span><span class="p">(),</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredLoadProfiles</span>
    <span class="p">)</span>
        
<span class="n">details</span><span class="o">.</span><span class="n">_load_all_stored_configs</span><span class="p">(</span>
    <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeThermalLoadDataDirectory</span><span class="p">(),</span>
    <span class="n">details</span><span class="o">.</span><span class="n">StoredThermalProfiles</span>
    <span class="p">)</span>
        
<span class="n">details</span><span class="o">.</span><span class="n">_load_all_stored_configs</span><span class="p">(</span>
    <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeSolarDataDirectory</span><span class="p">(),</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredSolarProfiles</span>
    <span class="p">)</span>
        
<span class="n">details</span><span class="o">.</span><span class="n">_load_all_stored_configs</span><span class="p">(</span>
    <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeWindDataDirectory</span><span class="p">(),</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredWindProfiles</span>
    <span class="p">)</span>
        
<span class="n">details</span><span class="o">.</span><span class="n">_load_all_stored_configs</span><span class="p">(</span>
    <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeHydroDataDirectory</span><span class="p">(),</span> <span class="n">details</span><span class="o">.</span><span class="n">StoredHydroProfiles</span>
    <span class="p">)</span>
    
<div class="viewcode-block" id="FindStoredSolarConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.FindStoredSolarConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">FindStoredSolarConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function searches through all previously defined stored solar</span>
<span class="sd">    resource data sets and returns the one found with the supplied name or None.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the stored profile to find.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The found stored solar data set with data loaded or None if there is no</span>
<span class="sd">        data set by the supplied name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_find_and_load_stored_config</span><span class="p">(</span>
        <span class="n">details</span><span class="o">.</span><span class="n">StoredSolarProfiles</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">find_fail_behavior</span><span class="o">=</span><span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span><span class="p">,</span>
        <span class="n">find_context</span><span class="o">=</span><span class="s2">&quot;stored solar data configurations&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="FindStoredLoadConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.FindStoredLoadConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">FindStoredLoadConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function searches through all previously defined stored load</span>
<span class="sd">    profile data sets and returns the one found with the supplied name or None.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the stored profile to find.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The found stored load data set with data loaded or None if there is no</span>
<span class="sd">        data set by the supplied name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_find_and_load_stored_config</span><span class="p">(</span>
        <span class="n">details</span><span class="o">.</span><span class="n">StoredLoadProfiles</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">find_fail_behavior</span><span class="o">=</span><span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span><span class="p">,</span>
        <span class="n">find_context</span><span class="o">=</span><span class="s2">&quot;stored load data configurations&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="FindStoredWindConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.FindStoredWindConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">FindStoredWindConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function searches through all previously defined stored wind</span>
<span class="sd">    resource data sets and returns the one found with the supplied name or None.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the stored profile to find.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The found stored wind data set with data loaded or None if there is no</span>
<span class="sd">        data set by the supplied name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_find_and_load_stored_config</span><span class="p">(</span>
        <span class="n">details</span><span class="o">.</span><span class="n">StoredWindProfiles</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">find_fail_behavior</span><span class="o">=</span><span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span><span class="p">,</span>
        <span class="n">find_context</span><span class="o">=</span><span class="s2">&quot;stored wind data configurations&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="FindStoredHydroConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.FindStoredHydroConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">FindStoredHydroConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function searches through all previously defined stored hydro</span>
<span class="sd">    resource data sets and returns the one found with the supplied name or None.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the stored profile to find.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The found stored hydro data set with data loaded or None if there is no</span>
<span class="sd">        data set by the supplied name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_find_and_load_stored_config</span><span class="p">(</span><span class="n">details</span><span class="o">.</span><span class="n">StoredHydroProfiles</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="FindStoredThermalConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.FindStoredThermalConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">FindStoredThermalConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function searches through all previously defined stored thermal</span>
<span class="sd">    load data sets and returns the one found with the supplied name or None.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the stored profile to find.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The found stored thermal data set with data loaded or None if there is</span>
<span class="sd">        no data set by the supplied name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_find_and_load_stored_config</span><span class="p">(</span>
        <span class="n">details</span><span class="o">.</span><span class="n">StoredThermalProfiles</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">find_fail_behavior</span><span class="o">=</span><span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">find_fail_behavior</span><span class="o">.</span><span class="n">throw</span><span class="p">,</span>
        <span class="n">find_context</span><span class="o">=</span><span class="s2">&quot;stored thermal data configurations&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MakeStoredLoadConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeStoredLoadConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">MakeStoredLoadConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new file containing load data information</span>
<span class="sd">    and makes it available for use in any models.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this stored data file.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created data set.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to be stored in this new stored data file.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            new file.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this new file.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            new file.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this new file.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting data set.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The newly created representation of the new data file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_create_stored_data_file</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeLoadDataDirectory</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MakeStoredSolarDataConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeStoredSolarDataConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">MakeStoredSolarDataConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new file containing solar data information</span>
<span class="sd">    and makes it available for use in any models.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this stored data file.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created data set.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to be stored in this new stored data file.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            new file.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this new file.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            new file.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this new file.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting data set.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The newly created representation of the new data file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_create_stored_data_file</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeSolarDataDirectory</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MakeStoredWindDataConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeStoredWindDataConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">MakeStoredWindDataConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new file containing wind data information</span>
<span class="sd">    and makes it available for use in any models.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this stored data file.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created data set.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to be stored in this new stored data file.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            new file.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this new file.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            new file.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this new file.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting data set.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The newly created representation of the new data file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_create_stored_data_file</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeWindDataDirectory</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MakeStoredHydroDataConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeStoredHydroDataConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">MakeStoredHydroDataConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new file containing hydro data</span>
<span class="sd">    information and makes it available for use in any models.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this stored data file.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created data set.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to be stored in this new stored data file.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            new file.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this new file.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            new file.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this new file.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting data set.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The newly created representation of the new data file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_create_stored_data_file</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeHydroDataDirectory</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MakeStoredThermalDataConfiguration">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeStoredThermalDataConfiguration">[docs]</a>
<span class="k">def</span> <span class="nf">MakeStoredThermalDataConfiguration</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">StoredTierLoadConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new file containing thermal data</span>
<span class="sd">    information and makes it available for use in any models.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this stored data file.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">                </span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created data set.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to be stored in this new stored data file.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            new file.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this new file.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            new file.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this new file.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting data set.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.StoredTierLoadConfiguration:</span>
<span class="sd">        The newly created representation of the new data file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_create_stored_data_file</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">MakeThermalDataDirectory</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MakeLine">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeLine">[docs]</a>
<span class="k">def</span> <span class="nf">MakeLine</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">sn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Line</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new line, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this line is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this microgrid is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this line.  Names of lines within a microgrid</span>
<span class="sd">        must be unique.  If the name is None, then a default name is generated</span>
<span class="sd">        using the first and second nodes.</span>
<span class="sd">    fn</span>
<span class="sd">        The node to which to attach the first end of this line. This parameter</span>
<span class="sd">        can be None if you wish to assign the first node at a later time.</span>
<span class="sd">    sn</span>
<span class="sd">        The node to which to attach the second end of this line. This parameter</span>
<span class="sd">        can be None if you wish to assign the second node at a later time.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new line.  If not provided, the</span>
<span class="sd">            baseline specification is No Line.  This can  either be provided as</span>
<span class="sd">            an MDT.LineSpec object or as the name of the specification</span>
<span class="sd">            in which case a search will be conducted to find and assign the</span>
<span class="sd">            correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new line. This can</span>
<span class="sd">            be provided as a single entity or a list of entities. Each  entity</span>
<span class="sd">            can either be provided as an MDT.LineSpec object or as the</span>
<span class="sd">            name of the specification to use in which case a search of the</span>
<span class="sd">            master list will be conducted to find and assign the correct spec.</span>
<span class="sd">        length: float</span>
<span class="sd">            A value that is greater than or equal to 0 to be the length of the</span>
<span class="sd">            new line (ft).</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new line.  This</span>
<span class="sd">            is typically used when the new line is being created for a microgrid</span>
<span class="sd">            design option in which case the MDT.MicrogridDesignOption instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied</span>
<span class="sd">            microgrid (mg) is used.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting line.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Line:</span>
<span class="sd">        The newly created line instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_line</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">sn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddLineCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Lines&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span> 
    <span class="k">return</span> <span class="n">l</span></div>


<div class="viewcode-block" id="MakeTransformer">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeTransformer">[docs]</a>
<span class="k">def</span> <span class="nf">MakeTransformer</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Transformer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new transformer, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this transformer is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this microgrid is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this transformer.  Names of transformers within</span>
<span class="sd">        a microgrid must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new transformer.  If not</span>
<span class="sd">            provided, the baseline specification is No Transformer.  This can</span>
<span class="sd">            either be provided as an MDT.TransformerSpec object or as</span>
<span class="sd">            the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new transformer.</span>
<span class="sd">            This can be provided as a single entity or a list of entities. Each </span>
<span class="sd">            entity can either be provided as an MDT.TransformerSpecification</span>
<span class="sd">            object or as the name of the specification to use in which case a</span>
<span class="sd">            search of the master list will be conducted to find and assign the</span>
<span class="sd">            correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new transformer. </span>
<span class="sd">            This is typically used when the new transformer is being created for</span>
<span class="sd">            a microgrid design option in which case the</span>
<span class="sd">            MDT.MicrogridDesignOption instance should be supplied.  If no owner</span>
<span class="sd">            is provided, then the supplied microgrid (mg) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting transformer.  This is only useful if you intend to save</span>
<span class="sd">            and open a model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting transformer.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Transformer:</span>
<span class="sd">        The newly created transformer instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_tranformer</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddTransformerCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Transformers&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="MakeSwitch">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeSwitch">[docs]</a>
<span class="k">def</span> <span class="nf">MakeSwitch</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Switch</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new switch, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this switch is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this microgrid is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this switch.  Names of switches within a</span>
<span class="sd">        microgrid must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new switch.  If not provided, the</span>
<span class="sd">            baseline specification is No Switch.  This can either be provided as</span>
<span class="sd">            an MDT.SwitchSpec object or as the name of the</span>
<span class="sd">            specification in which case a search will be conducted to find and</span>
<span class="sd">            assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new switch. This</span>
<span class="sd">            can be provided as a single entity or a list of entities. Each </span>
<span class="sd">            entity can either be provided as an MDT.SwitchSpec object</span>
<span class="sd">            or as the name of the specification to use in which case a search of</span>
<span class="sd">            the master list will be conducted to find and assign the correct</span>
<span class="sd">            spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new switch. </span>
<span class="sd">            This is typically used when the new switch is being created for</span>
<span class="sd">            a microgrid design option in which case the</span>
<span class="sd">            MDT.MicrogridDesignOption instance should be supplied.  If no owner</span>
<span class="sd">            is provided, then the supplied microgrid (mg) is used.    </span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting switch. This is only useful if you intend to save and open</span>
<span class="sd">            a model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting switch.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Switch:</span>
<span class="sd">        The newly created switch instance.   </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sw</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_switch</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddSwitchCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Switches&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">sw</span></div>


<div class="viewcode-block" id="MakeBus">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeBus">[docs]</a>
<span class="k">def</span> <span class="nf">MakeBus</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new bus, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this bus is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this node.  Names of nodes within a microgrid</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting bus. This is only useful if you intend to save and open a</span>
<span class="sd">            model in the MDT GUI.</span>
<span class="sd">        voltage</span>
<span class="sd">            A 2 element tuple or a list with 2 items in it where the first is</span>
<span class="sd">            the real part and the second is the imaginary.</span>
<span class="sd">        real: float</span>
<span class="sd">            The real component of voltage.  Only used if the &quot;voltage&quot; keyword</span>
<span class="sd">            argument is not provided.</span>
<span class="sd">        imaginary: float</span>
<span class="sd">            The imaginary component of voltage.  Only used if the &quot;voltage&quot;</span>
<span class="sd">            keyword argument is not provided.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new bus.  This</span>
<span class="sd">            is typically used if one does not want the bus added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting node.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Bus:</span>
<span class="sd">        The newly created bus instance.       </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_bus</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddBusCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Busses&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span></div>


<div class="viewcode-block" id="MakeMicrogrid">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeMicrogrid">[docs]</a>
<span class="k">def</span> <span class="nf">MakeMicrogrid</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new microgrid, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s: MDT.Site</span>
<span class="sd">        The site for which this microgrid is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this microgrid.  Names of microgrids within a</span>
<span class="sd">        site must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new microgrid.</span>
<span class="sd">            This is typically used if one does not want the microgrid added to</span>
<span class="sd">            the site as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied site (s) is</span>
<span class="sd">            used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting microgrid.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new microgrid.  This can be a</span>
<span class="sd">            string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created, random</span>
<span class="sd">            Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Microgrid:</span>
<span class="sd">        The newly created microgrid instance.       </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_microgrid</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddModelCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Models&quot;</span><span class="p">,</span> <span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">mg</span></div>


<div class="viewcode-block" id="MakeNode">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeNode">[docs]</a>
<span class="k">def</span> <span class="nf">MakeNode</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new node, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this node is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this microgrid is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this node.  Names of nodes within a microgrid</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new node. This is</span>
<span class="sd">            typically used when the new node is being created for a microgrid</span>
<span class="sd">            design option in which case the MDT.MicrogridDesignOption instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied</span>
<span class="sd">            microgrid (mg) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting node. This is only useful if you intend to save and open a</span>
<span class="sd">            model in the MDT GUI.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting node.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Node:</span>
<span class="sd">        The newly created node instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_node</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddNodeCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Nodes&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span></div>


<div class="viewcode-block" id="MakeDieselTank">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeDieselTank">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDieselTank</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselTank</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new diesel tank, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this tank is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this microgrid is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this tank.  Names of tanks within a microgrid</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new tank.  If not provided, the</span>
<span class="sd">            baseline specification is No Tank.  This can either be provided as</span>
<span class="sd">            an MDT.DieselTankSpec object or as the name of the</span>
<span class="sd">            specification in which case a search will be conducted to find and</span>
<span class="sd">            assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new tank. This can</span>
<span class="sd">            be provided as a single entity or a list of entities. Each  entity</span>
<span class="sd">            can either be provided as an MDT.DieselTankSpec object or</span>
<span class="sd">            as the name of the specification to use in which case a search of</span>
<span class="sd">            the master list will be conducted to find and assign the correct</span>
<span class="sd">            spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new tank. This</span>
<span class="sd">            is typically used when the new tank is being created for a microgrid</span>
<span class="sd">            design option in which case the MDT.MicrogridDesignOption instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied</span>
<span class="sd">            microgrid (mg) is used.    </span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting tank. This is only useful if you intend to save and open a</span>
<span class="sd">            model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        infinite_fuel: bool</span>
<span class="sd">            Whether or not this tank should be granted infinite fuel in the</span>
<span class="sd">            controller settings.  The default is False.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting tank.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.DieselTank:</span>
<span class="sd">        The newly created diesel tank instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_diesel_tank</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddDieselTankCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_DieselTanks&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="MakePropaneTank">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakePropaneTank">[docs]</a>
<span class="k">def</span> <span class="nf">MakePropaneTank</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneTank</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new propane tank, extracts any provided</span>
<span class="sd">    properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this tank is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this microgrid is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this tank.  Names of tanks within a microgrid</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new tank.  If not  provided, the</span>
<span class="sd">            baseline specification is No Tank.  This can either be provided as</span>
<span class="sd">            an MDT.PropaneTankSpec object or as the name of the</span>
<span class="sd">            specification in which case a search will be conducted to find and</span>
<span class="sd">            assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new tank. This can</span>
<span class="sd">            be provided as a single entity or a list of entities. Each  entity</span>
<span class="sd">            can either be provided as an MDT.PropaneTankSpec object or</span>
<span class="sd">            as the name of the specification to use in which case a search of</span>
<span class="sd">            the master list will be conducted to find and assign the correct</span>
<span class="sd">            spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new tank. This is</span>
<span class="sd">            typically used when the new tank is being created for a microgrid</span>
<span class="sd">            design option in which case the MDT.MicrogridDesignOption instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied</span>
<span class="sd">            microgrid (mg) is used.    </span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting tank. This is only useful if you intend to save and open a</span>
<span class="sd">            model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        infinite_fuel: bool</span>
<span class="sd">            Whether or not this tank should be granted infinite fuel in the</span>
<span class="sd">            controller settings.  The default is False.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting propane tank.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.PropaneTank:</span>
<span class="sd">        The newly created propane tank instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_propane_tank</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddPropaneTankCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_PropaneTanks&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="MakeDieselGenerator">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeDieselGenerator">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDieselGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new diesel generator, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this diesel generator is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this diesel generator.  Names of diesel generators</span>
<span class="sd">        within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new diesel generator.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.DieselGeneratorSpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new diesel</span>
<span class="sd">            generator. This can be provided as a single entity or a list of</span>
<span class="sd">            entities. Each  entity can either be provided as an</span>
<span class="sd">            MDT.DieselGeneratorSpec object or as the name of the</span>
<span class="sd">            specification to use in which case a search of the master list will</span>
<span class="sd">            be conducted to find and assign the correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new diesel</span>
<span class="sd">            generator.  This is typically used when the new diesel generator is</span>
<span class="sd">            being created for a microgrid design option in which case the</span>
<span class="sd">            MDT.BusDesignOption made for the microgrid design option instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied bus</span>
<span class="sd">            (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting diesel generator. This is only useful if you intend to</span>
<span class="sd">            save and open a model in the MDT GUI.</span>
<span class="sd">        tanks:</span>
<span class="sd">            The list of the diesel tanks to be assigned to the new diesel</span>
<span class="sd">            generator.  This input can be an MDT.DieselTank instance, the name</span>
<span class="sd">            of a diesel tank in which case a search will be conducted to find</span>
<span class="sd">            the correct tank in the supplied microgrid, or a list of instances</span>
<span class="sd">            and/or names.  If not provided, no tanks are assigned.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting diesel generator.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.DieselGenerator:</span>
<span class="sd">        The newly created diesel generator instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_diesel_generator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddDieselGeneratorCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_DieselGenerators&quot;</span><span class="p">,</span> <span class="n">dg</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">dg</span></div>


<div class="viewcode-block" id="MakeBattery">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeBattery">[docs]</a>
<span class="k">def</span> <span class="nf">MakeBattery</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Battery</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new battery, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this battery is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this battery.  Names of batteries within a bus</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new battery.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.BatterySpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new battery. This</span>
<span class="sd">            can be provided as a single entity or a list of entities. Each</span>
<span class="sd">            entity can either be provided as an MDT.BatterySpec object</span>
<span class="sd">            or as the name of the specification to use in which case a search of</span>
<span class="sd">            the master list will be conducted to find and assign the correct</span>
<span class="sd">            spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new battery.</span>
<span class="sd">            This is typically used when the new battery is being created for a</span>
<span class="sd">            microgrid design option in which case the MDT.BusDesignOption made</span>
<span class="sd">            for the microgrid design option instance should be supplied.  If no</span>
<span class="sd">            owner is provided, then the supplied bus (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting battery. This is only useful if you intend to</span>
<span class="sd">            save and open a model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting battery.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Battery:</span>
<span class="sd">        The newly created battery instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bat</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_battery</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddBatteryCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Batteries&quot;</span><span class="p">,</span> <span class="n">bat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">bat</span></div>


<div class="viewcode-block" id="MakeInverter">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeInverter">[docs]</a>
<span class="k">def</span> <span class="nf">MakeInverter</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Inverter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new inverter, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this inverter is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this inverter.  Names of inverters within a bus</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec</span>
<span class="sd">            The baseline specification for the new inverter.  If not provided,</span>
<span class="sd">            the baseline specification is No Generator.  This can either be</span>
<span class="sd">            provided as an MDT.BatterySpec object or as the name of the</span>
<span class="sd">            specification in which case a search will be conducted to find and</span>
<span class="sd">            assign the correct spec in the master list.</span>
<span class="sd">        specs</span>
<span class="sd">            The list of all allowable specifications for the new inverter. This</span>
<span class="sd">            can be provided as a single entity or a list of entities. Each</span>
<span class="sd">            entity can either be provided as an MDT.BatterySpec object</span>
<span class="sd">            or as the name of the specification to use in which case a search of</span>
<span class="sd">            the master list will be conducted to find and assign the correct</span>
<span class="sd">            spec.</span>
<span class="sd">        owner</span>
<span class="sd">            An optional parameter to serve as the owner of the new inverter.</span>
<span class="sd">            This is typically used when the new inverter is being created for a</span>
<span class="sd">            microgrid design option in which case the MDT.BusDesignOption made</span>
<span class="sd">            for the microgrid design option instance should be supplied.  If no</span>
<span class="sd">            owner is provided, then the supplied bus (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting inverter. This is only useful if you intend to</span>
<span class="sd">            save and open a model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes</span>
<span class="sd">            Any notes to assign to the resulting inverter.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Inverter:</span>
<span class="sd">        The newly created inverter instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inv</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_inverter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddInverterCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Inverters&quot;</span><span class="p">,</span> <span class="n">inv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">inv</span></div>


<div class="viewcode-block" id="MakeUPS">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeUPS">[docs]</a>
<span class="k">def</span> <span class="nf">MakeUPS</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">UninterruptiblePowerSupply</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new UPS, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this UPS is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this UPS.  Names of UPSs within a bus</span>
<span class="sd">        must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new UPS.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.UPSSpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new UPS. This</span>
<span class="sd">            can be provided as a single entity or a list of entities. Each</span>
<span class="sd">            entity can either be provided as an MDT.UPSSpec object</span>
<span class="sd">            or as the name of the specification to use in which case a search of</span>
<span class="sd">            the master list will be conducted to find and assign the correct</span>
<span class="sd">            spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new UPS.</span>
<span class="sd">            This is typically used when the new UPS is being created for a</span>
<span class="sd">            microgrid design option in which case the MDT.BusDesignOption made</span>
<span class="sd">            for the microgrid design option instance should be supplied.  If no</span>
<span class="sd">            owner is provided, then the supplied bus (b) is used.</span>
<span class="sd">        load_section: MDT.LoadSection</span>
<span class="sd">            The load section to which this UPS is assigned and to which it will</span>
<span class="sd">            provide power when/if necessary.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting UPS. This is only useful if you intend to</span>
<span class="sd">            save and open a model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting UPS.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.UninterruptiblePowerSupply:</span>
<span class="sd">        The newly created UPS instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ups</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_ups</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddUninterruptiblePowerSupplyCanceled&quot;</span><span class="p">,</span>
            <span class="s2">&quot;get_UninterruptiblePowerSupplies&quot;</span><span class="p">,</span> <span class="n">ups</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">ups</span></div>


<div class="viewcode-block" id="MakePropaneGenerator">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakePropaneGenerator">[docs]</a>
<span class="k">def</span> <span class="nf">MakePropaneGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new propane generator, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this propane generator is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this propane generator.  Names of propane</span>
<span class="sd">        generators within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new propane generator.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.PropaneGeneratorSpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new propane</span>
<span class="sd">            generator. This can be provided as a single entity or a list of</span>
<span class="sd">            entities. Each  entity can either be provided as an</span>
<span class="sd">            MDT.PropaneGeneratorSpec object or as the name of the</span>
<span class="sd">            specification to use in which case a search of the master list will</span>
<span class="sd">            be conducted to find and assign the correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new propane</span>
<span class="sd">            generator.  This is typically used when the new propane generator is</span>
<span class="sd">            being created for a microgrid design option in which case the</span>
<span class="sd">            MDT.BusDesignOption made for the microgrid design option instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied bus</span>
<span class="sd">            (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting propane generator. This is only useful if you intend to</span>
<span class="sd">            save and open a model in the MDT GUI.</span>
<span class="sd">        tanks:</span>
<span class="sd">            The list of the propane tanks to be assigned to the new propane</span>
<span class="sd">            generator.  This input can be an MDT.PropaneTank instance, the name</span>
<span class="sd">            of a propane tank in which case a search will be conducted to find</span>
<span class="sd">            the correct tank in the supplied microgrid, or a list of instances</span>
<span class="sd">            and/or names.  If not provided, no tanks are assigned.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting propane generator.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.PropaneGenerator:</span>
<span class="sd">        The newly created propane generator instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_propane_generator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddPropaneGeneratorCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_PropaneGenerators&quot;</span><span class="p">,</span> <span class="n">pg</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">pg</span></div>


<div class="viewcode-block" id="MakeNaturalGasGenerator">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeNaturalGasGenerator">[docs]</a>
<span class="k">def</span> <span class="nf">MakeNaturalGasGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">NaturalGasGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new natural gas generator, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this natural gas generator is being built.  If an</span>
<span class="sd">        &quot;owner&quot; parameter is not provided, then this bus is also used as the</span>
<span class="sd">        owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this natural gas generator.  Names of natural</span>
<span class="sd">        gas generators within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new natural gas generator.  If</span>
<span class="sd">            not provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.NaturalGasGeneratorSpec object</span>
<span class="sd">            or as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new natural gas</span>
<span class="sd">            generator. This can be provided as a single entity or a list of</span>
<span class="sd">            entities. Each  entity can either be provided as an</span>
<span class="sd">            MDT.NaturalGasGeneratorSpec object or as the name of the</span>
<span class="sd">            specification to use in which case a search of the master list will</span>
<span class="sd">            be conducted to find and assign the correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new natural gas</span>
<span class="sd">            generator.  This is typically used when the new natural gas</span>
<span class="sd">            generator is being created for a microgrid design option in which</span>
<span class="sd">            case the MDT.BusDesignOption made for the microgrid design option</span>
<span class="sd">            instance should be supplied.  If no owner is provided, then the</span>
<span class="sd">            supplied bus (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting natural gas generator. This is only useful if you intend</span>
<span class="sd">            to save and open a model in the MDT GUI.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting natural gas generator.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.NaturalGasGenerator:</span>
<span class="sd">        The newly created natural gas generator instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ngg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_natural_gas_generator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddNaturalGasGeneratorCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_NaturalGasGenerators&quot;</span><span class="p">,</span>
            <span class="n">ngg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">ngg</span></div>


<div class="viewcode-block" id="MakeSolarGenerator">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeSolarGenerator">[docs]</a>
<span class="k">def</span> <span class="nf">MakeSolarGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SolarGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new solar generator, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this solar generator is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this solar generator.  Names of solar generators</span>
<span class="sd">        within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new solar generator.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.SolarGeneratorSpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new solar</span>
<span class="sd">            generator. This can be provided as a single entity or a list of</span>
<span class="sd">            entities. Each  entity can either be provided as an</span>
<span class="sd">            MDT.SolarGeneratorSpec object or as the name of the</span>
<span class="sd">            specification to use in which case a search of the master list will</span>
<span class="sd">            be conducted to find and assign the correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new solar</span>
<span class="sd">            generator.  This is typically used when the new solar generator is</span>
<span class="sd">            being created for a microgrid design option in which case the</span>
<span class="sd">            MDT.BusDesignOption made for the microgrid design option instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied bus</span>
<span class="sd">            (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting solar generator. This is only useful if you intend to save</span>
<span class="sd">            and open a model in the MDT GUI.</span>
<span class="sd">        resource:</span>
<span class="sd">            The instance or name of the solar resource to be assigned to the</span>
<span class="sd">            new solar generator.  If not provided, no resource is assigned.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting solar generator.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.SolarGenerator:</span>
<span class="sd">        The newly created solar instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_solar_generator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddSolarGeneratorCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_SolarGenerators&quot;</span><span class="p">,</span> <span class="n">sg</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">sg</span></div>


<div class="viewcode-block" id="MakeWindGenerator">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeWindGenerator">[docs]</a>
<span class="k">def</span> <span class="nf">MakeWindGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">WindGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new wind generator, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this wind generator is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this wind generator.  Names of wind generators</span>
<span class="sd">        within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new wind generator.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.WindGeneratorSpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new wind generator.</span>
<span class="sd">            This can be provided as a single entity or a list of entities. Each</span>
<span class="sd">            entity can either be provided as an MDT.WindGeneratorSpecification</span>
<span class="sd">            object or as the name of the specification to use in which case a</span>
<span class="sd">            search of the master list will be conducted to find and assign the</span>
<span class="sd">            correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new wind</span>
<span class="sd">            generator.  This is typically used when the new wind generator is</span>
<span class="sd">            being created for a microgrid design option in which case the</span>
<span class="sd">            MDT.BusDesignOption made for the microgrid design option instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied bus</span>
<span class="sd">            (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting wind generator. This is only useful if you intend to save</span>
<span class="sd">            and open a model in the MDT GUI.</span>
<span class="sd">        resource:</span>
<span class="sd">            The instance or name of the wind resource to be assigned to the</span>
<span class="sd">            new wind generator.  If not provided, no resource is assigned.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting wind generator.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.WindGenerator:</span>
<span class="sd">        The newly created wind instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_wind_generator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddWindGeneratorCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_WindGenerators&quot;</span><span class="p">,</span> <span class="n">wg</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">wg</span></div>


<div class="viewcode-block" id="MakeHydroGenerator">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeHydroGenerator">[docs]</a>
<span class="k">def</span> <span class="nf">MakeHydroGenerator</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">HydroGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new hydro generator, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this hydro generator is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this hydro generator.  Names of hydro generators</span>
<span class="sd">        within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        base_spec:</span>
<span class="sd">            The baseline specification for the new hydro generator.  If not</span>
<span class="sd">            provided, the baseline specification is No Generator.  This can</span>
<span class="sd">            either be provided as an MDT.HydroGeneratorSpec object or</span>
<span class="sd">            as the name of the specification in which case a search will be</span>
<span class="sd">            conducted to find and assign the correct spec in the master list.</span>
<span class="sd">        specs:</span>
<span class="sd">            The list of all allowable specifications for the new hydro</span>
<span class="sd">            generator. This can be provided as a single entity or a list of</span>
<span class="sd">            entities. Each entity can either be provided as an</span>
<span class="sd">            MDT.HydroGeneratorSpec object or as the name of the</span>
<span class="sd">            specification to use in which case a search of the master list will</span>
<span class="sd">            be conducted to find and assign the correct spec.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new hydro</span>
<span class="sd">            generator.  This is typically used when the new hydro generator is</span>
<span class="sd">            being created for a microgrid design option in which case the</span>
<span class="sd">            MDT.BusDesignOption made for the microgrid design option instance</span>
<span class="sd">            should be supplied.  If no owner is provided, then the supplied bus</span>
<span class="sd">            (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting hydro generator. This is only useful if you intend to save</span>
<span class="sd">            and open a model in the MDT GUI.</span>
<span class="sd">        resource:</span>
<span class="sd">            The instance or name of the hydro resource to be assigned to the</span>
<span class="sd">            new hydro generator.  If not provided, no resource is assigned.</span>
<span class="sd">        retrofit_cost: float</span>
<span class="sd">            The cost, if any, to keep the baseline specification in a solution.</span>
<span class="sd">            If not supplied, the value defaults to $0.</span>
<span class="sd">        failure_modes:</span>
<span class="sd">            A list of all defined failure modes for the resulting component,</span>
<span class="sd">            if any.  The elements of the list are of type MDT.FailureMode.</span>
<span class="sd">        fragilities:</span>
<span class="sd">            A dictionary in which the keys are hazards and the values are</span>
<span class="sd">            fragility curves for those hazards.  Each entry in the dictionary</span>
<span class="sd">            results in a fragility for the new component.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting hydro generator.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.HydroGenerator:</span>
<span class="sd">        The newly created hydro instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_hydro_generator</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddHydroGeneratorCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_HydroGenerators&quot;</span><span class="p">,</span> <span class="n">hg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">hg</span></div>


<div class="viewcode-block" id="MakeSolarResource">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeSolarResource">[docs]</a>
<span class="k">def</span> <span class="nf">MakeSolarResource</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SolarResource</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new solar resource, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s: MDT.Site</span>
<span class="sd">        The site for which this solar resource is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this solar resource.  Names of solar resources</span>
<span class="sd">        within a site must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to assign to this newly created resource.  This is only</span>
<span class="sd">            used of a stored_configuration is not provided.</span>
<span class="sd">        stored_configuration:</span>
<span class="sd">            Either an MDT.StoredTierLoadConfiguration or the name of one to be</span>
<span class="sd">            used as the load data for this new data object.  If this is</span>
<span class="sd">            provided, then the data, period, period_units, interval, and</span>
<span class="sd">            interval_units are all taken from this configuration object and any</span>
<span class="sd">            that were provided are ignored.  If a stored configuration is not to</span>
<span class="sd">            be used, then don&#39;t provide this parameter.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            resource.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this resource.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            resource.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this resource.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new resource.</span>
<span class="sd">            This is typically used if one does not want the resource added to</span>
<span class="sd">            the site as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied site (s) is</span>
<span class="sd">            used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting solar resource.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.SolarResource:</span>
<span class="sd">        The newly created solar resource instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_solar_resource</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddSolarResourceCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_SolarResources&quot;</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">sr</span></div>


<div class="viewcode-block" id="MakeWindResource">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeWindResource">[docs]</a>
<span class="k">def</span> <span class="nf">MakeWindResource</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">WindResource</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new wind resource, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s: MDT.Site</span>
<span class="sd">        The site for which this wind resource is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this wind resource.  Names of wind resources</span>
<span class="sd">        within a site must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to assign to this newly created resource.  This is only</span>
<span class="sd">            used of a stored_configuration is not provided.</span>
<span class="sd">        stored_configuration:</span>
<span class="sd">            Either an MDT.StoredTierLoadConfiguration or the name of one to be</span>
<span class="sd">            used as the load data for this new data object.  If this is</span>
<span class="sd">            provided, then the data, period, period_units, interval, and</span>
<span class="sd">            interval_units are all taken from this configuration object and any</span>
<span class="sd">            that were provided are ignored.  If a stored configuration is not to</span>
<span class="sd">            be used, then don&#39;t provide this parameter.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            resource.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this resource.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            resource.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this resource.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new resource.</span>
<span class="sd">            This is typically used if one does not want the resource added to</span>
<span class="sd">            the site as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied site (s) is</span>
<span class="sd">            used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting wind resource.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.WindResource:</span>
<span class="sd">        The newly created wind resource instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wr</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_wind_resource</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddWindResourceCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_WindResources&quot;</span><span class="p">,</span> <span class="n">wr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">wr</span></div>


<div class="viewcode-block" id="MakeHydroResource">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeHydroResource">[docs]</a>
<span class="k">def</span> <span class="nf">MakeHydroResource</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">HydroResource</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new hydro resource, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s: MDT.Site</span>
<span class="sd">        The site for which this hydro resource is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this hydro resource.  Names of hydro resources</span>
<span class="sd">        within a site must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        data: iterable of float</span>
<span class="sd">            The data to assign to this newly created resource.  The number of</span>
<span class="sd">            elements that should be in the list, if any, is determined by the</span>
<span class="sd">            period, period units, interval, and interval units of the owning</span>
<span class="sd">            load container (lc).  This is only used of a stored_configuration is</span>
<span class="sd">            not provided.</span>
<span class="sd">        stored_configuration:</span>
<span class="sd">            Either an MDT.StoredTierLoadConfiguration or the name of one to be</span>
<span class="sd">            used as the load data for this new data object.  If this is</span>
<span class="sd">            provided, then the data, period, period_units, interval, and</span>
<span class="sd">            interval_units are all taken from this configuration object and any</span>
<span class="sd">            that were provided are ignored.  If a stored configuration is not to</span>
<span class="sd">            be used, then don&#39;t provide this parameter.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            resource.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this resource.  The period</span>
<span class="sd">            is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            resource.  The interval is the total time duration of the data set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this resource.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new resource.</span>
<span class="sd">            This is typically used if one does not want the resource added to</span>
<span class="sd">            the site as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied site (s) is</span>
<span class="sd">            used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting hydro resource.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.HydroResource:</span>
<span class="sd">        The newly created hydro resource instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hr</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_hydro_resource</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddHydroResourceCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_HydroResources&quot;</span><span class="p">,</span> <span class="n">hr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">hr</span></div>


<div class="viewcode-block" id="MakeLoadSection">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeLoadSection">[docs]</a>
<span class="k">def</span> <span class="nf">MakeLoadSection</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadSection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new load section, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this load section is being built.  If an &quot;owner&quot;</span>
<span class="sd">        parameter is not provided, then this bus is also used as the owner.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this load section.  Names of load sections</span>
<span class="sd">        within a bus must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new load section.</span>
<span class="sd">            This is typically used when the new load section is being created</span>
<span class="sd">            for a microgrid design option in which case the MDT.BusDesignOption</span>
<span class="sd">            made for the microgrid design option instance should be supplied.</span>
<span class="sd">            If no owner is provided, then the supplied bus (b) is used.</span>
<span class="sd">        loc: tuple[float,float]</span>
<span class="sd">            An optional parameter to set the x,y diagram location for the</span>
<span class="sd">            resulting load section. This is only useful if you intend to save</span>
<span class="sd">            and open a model in the MDT GUI.</span>
<span class="sd">        period: int</span>
<span class="sd">            The number of period_units in the period of the data of this</span>
<span class="sd">            load section.  The period is the time duration between data points.</span>
<span class="sd">        period_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the period for the data of this load section.  The</span>
<span class="sd">            period is the time duration between data points.</span>
<span class="sd">        interval: int</span>
<span class="sd">            The number of interval_units in the interval of the data of this</span>
<span class="sd">            load section.  The interval is the total time duration of the data</span>
<span class="sd">            set.</span>
<span class="sd">        interval_units: Common.Time.TimeAccumulation.Units</span>
<span class="sd">            The units of the interval for the data of this load section.  The</span>
<span class="sd">            interval is the total time duration of the data set.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting load section.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.LoadSection:</span>
<span class="sd">        The newly created solar load section instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_load_section</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddLoadSectionCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_LoadSections&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">ls</span></div>


<div class="viewcode-block" id="MakeLoadDataTier">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeLoadDataTier">[docs]</a>
<span class="k">def</span> <span class="nf">MakeLoadDataTier</span><span class="p">(</span><span class="n">lc</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">ILoadContainer</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadDataWithTier</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new load section, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lc: MDT.ILoadContainer</span>
<span class="sd">        The load container that will hold the newly created data.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this new load data set.  Names of tier load</span>
<span class="sd">        data sets within a load container must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created data set.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        data:</span>
<span class="sd">            A vector of double precision numbers to be the data assigned to this</span>
<span class="sd">            new tier load data set.  The number of elements that should be in</span>
<span class="sd">            the list, if any, is determined by the period, period units,</span>
<span class="sd">            interval, and interval units of the owning load container (lc).</span>
<span class="sd">            This input is ignored if a stored_configuration is provided.</span>
<span class="sd">        stored_configuration:</span>
<span class="sd">            Either an MDT.StoredTierLoadConfiguration or the name of one to be</span>
<span class="sd">            used as the load data for this new data object if desired.  If this</span>
<span class="sd">            is provided, then the data, period, period_units, interval, and</span>
<span class="sd">            interval_units are all taken from this configuration object and any</span>
<span class="sd">            that were provided are ignored.  If a stored configuration is not to</span>
<span class="sd">            be used, then don&#39;t provide this parameter.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new load data.</span>
<span class="sd">            This is typically used if one does not want the load data added to</span>
<span class="sd">            the container as part of this call in which case None is specified</span>
<span class="sd">            as the owner.  If no owner is provided, then the supplied container</span>
<span class="sd">            (lc) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting load data set.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.LoadDataWithTier:</span>
<span class="sd">        The newly created solar load data instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ldwt</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_load_data_with_tier</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;data&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_is_collection</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span> <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">!=</span> <span class="n">owner</span><span class="o">.</span><span class="n">get_NumTimePeriods</span><span class="p">():</span>
                <span class="n">errLog</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;err_log&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">GlobalErrorLog</span><span class="p">)</span>
                <span class="n">errLog</span><span class="o">.</span><span class="n">AddEntry</span><span class="p">(</span>
                    <span class="n">Common</span><span class="o">.</span><span class="n">Logging</span><span class="o">.</span><span class="n">LogCategories</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span>
                    <span class="s2">&quot;A dataset with &quot;</span> <span class="o">+</span>
                    <span class="n">Common</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">UtilFuncs</span><span class="o">.</span><span class="n">MakePluralPhrase</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                    <span class="s2">&quot; was provided for &quot;</span> <span class="o">+</span> <span class="n">owner</span><span class="o">.</span><span class="n">GetTypeAndIDString</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; that houses &quot;</span> <span class="o">+</span>
                    <span class="n">Common</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">UtilFuncs</span><span class="o">.</span><span class="n">MakePluralPhrase</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">.</span><span class="n">get_NumTimePeriods</span><span class="p">(),</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                    <span class="s2">&quot;.&quot;</span>
                    <span class="p">)</span>
        
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddLoadDataSetCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_LoadDataSets&quot;</span><span class="p">,</span> <span class="n">ldwt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">ldwt</span></div>


<div class="viewcode-block" id="MakeFailureMode">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeFailureMode">[docs]</a>
<span class="k">def</span> <span class="nf">MakeFailureMode</span><span class="p">(</span><span class="n">u</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">IUnreliable</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FailureMode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new failure mode, extracts any</span>
<span class="sd">    provided properties, loads it into its owner (u), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    u: MDT.IUnreliable</span>
<span class="sd">        The unreliable entity for which this failure mode is being built.  This</span>
<span class="sd">        argument can be None and if no owner is provided or the owner provided</span>
<span class="sd">        is None, then the returned mode will not be added to any owner.  It</span>
<span class="sd">        should thus be added to an owner at some later time.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to the new failure mode.  Names of failure modes</span>
<span class="sd">        within an unreliable entity must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        mtbf: Common.Distributions.IDistribution</span>
<span class="sd">            The probability distribution describing the mean time between</span>
<span class="sd">            failures for this failure mode.  This could also be a float in which</span>
<span class="sd">            case a fixed distribution will be used.</span>
<span class="sd">        mttr: Common.Distributions.IDistribution</span>
<span class="sd">            The probability distribution describing the mean time to repair for</span>
<span class="sd">            this failure mode.  This could also be a float in which case a fixed</span>
<span class="sd">            distribution will be used.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new failure mode.</span>
<span class="sd">            This is typically used if one does not want the failure mode added</span>
<span class="sd">            to the unreliable asset as part of this call in which case None is</span>
<span class="sd">            specified as the owner.  If no owner is provided, then the supplied</span>
<span class="sd">            unreliable (u) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting failure mode.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">            </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.FailureMode:</span>
<span class="sd">        The newly created and loaded failure mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fm</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_failure_mode</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddFailureModeCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_FailureModes&quot;</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">fm</span></div>

    
<div class="viewcode-block" id="MakeFragilityCurve">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeFragilityCurve">[docs]</a>
<span class="k">def</span> <span class="nf">MakeFragilityCurve</span><span class="p">(</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">IFragile</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">haz</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Hazard</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">FragilityCurve</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new fragility curve, extracts any</span>
<span class="sd">    provided properties, loads it into its owner (f) mapped to the supplied</span>
<span class="sd">    hazard, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f: MDT.IFragile</span>
<span class="sd">        The fragile entity for which this fragility curve is being built. This</span>
<span class="sd">        parameter can be None and if so, and if no explicit non-None owner is</span>
<span class="sd">        provided, the fragility curve will be built and returned but no mapping</span>
<span class="sd">        to haz will take place.  At some later time, the newly created fragility</span>
<span class="sd">        curve should be added to an asset mapped to a hazard.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to the new fragility curve.  Names of fragility</span>
<span class="sd">        curves within an unreliable entity must be unique.</span>
<span class="sd">    haz: MDT.Hazard</span>
<span class="sd">        The hazard to which this fragility curve applies in the given fragile</span>
<span class="sd">        entity.  If the parameter f is None, or if an explicit owner=None is</span>
<span class="sd">        provided, this parameter can also be None. Otherwise, it cannot.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        mttr: Common.Distributions.IDistribution</span>
<span class="sd">            The probability distribution describing the mean time to repair for</span>
<span class="sd">            this fragility curve.  This could also be a float in which case a</span>
<span class="sd">            fixed distribution will be used.</span>
<span class="sd">        probability_generator: Common.Distributions.IDistribution</span>
<span class="sd">            The distribution that determines the likelihood of failure in terms</span>
<span class="sd">            of the hazard intensity units for this fragility.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new fragility</span>
<span class="sd">            curve. This is typically used if one does not want the fragility</span>
<span class="sd">            curve added to the fragile asset as part of this call in which case</span>
<span class="sd">            None is specified as the owner.  If no owner is provided, then the</span>
<span class="sd">            supplied fragile asset (f) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting fragility curve.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">            </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.FragilityCurve:</span>
<span class="sd">        The newly created and loaded fragility curve.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_fragility_curve</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_execute_2_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddFragilityCurveCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_FragilityCurves&quot;</span><span class="p">,</span> <span class="n">haz</span><span class="p">,</span> <span class="n">fc</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">fc</span></div>


<div class="viewcode-block" id="MakeDesignBasisThreat">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeDesignBasisThreat">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDesignBasisThreat</span><span class="p">(</span><span class="n">pu</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PowerUtility</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DesignBasisThreat</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new design basis threat, extracts any</span>
<span class="sd">    provided properties, loads it into its owner (pu), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pu: MDT.PowerUtility</span>
<span class="sd">        The unreliable entity for which this design basis threat is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to the new design basis threat.  Names of design</span>
<span class="sd">        basis threat within an unreliable entity must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        mtbf: Common.Distributions.IDistribution</span>
<span class="sd">            The probability distribution describing the mean time between</span>
<span class="sd">            failures for this design basis threat.</span>
<span class="sd">        mttr: Common.Distributions.IDistribution</span>
<span class="sd">            The probability distribution describing the mean time to repair for</span>
<span class="sd">            this design basis threat.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new DBT.</span>
<span class="sd">            This is typically used if one does not want the DBT added to</span>
<span class="sd">            the power utility as part of this call in which case None is</span>
<span class="sd">            specified as the owner.  If no owner is provided, then the supplied</span>
<span class="sd">            power utility (pu) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting design basis threat.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.DesignBasisThreat:</span>
<span class="sd">        The newly created design basis threat instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dbt</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_design_basis_threat</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">pu</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddFailureModeCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_FailureModes&quot;</span><span class="p">,</span> <span class="n">dbt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">dbt</span></div>


<div class="viewcode-block" id="MakeHazard">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeHazard">[docs]</a>
<span class="k">def</span> <span class="nf">MakeHazard</span><span class="p">(</span><span class="n">dbt</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DesignBasisThreat</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Hazard</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new hazard, extracts any provided</span>
<span class="sd">    properties, loads it into the provided DBT, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dbt: MDT.DesignBasisThreat</span>
<span class="sd">        The DBT for which this hazard is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this hazard.  Names of hazards within a DBT must</span>
<span class="sd">        be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        intensity_generator: MDT.IDistribution</span>
<span class="sd">            The distribution from which intensity values are drawn at the onset</span>
<span class="sd">            of each DBT.</span>
<span class="sd">        units:</span>
<span class="sd">            The units of this hazard to be used as a label.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new hazard.</span>
<span class="sd">            This is typically used if one does not want the hazard added to</span>
<span class="sd">            the DBT as part of this call in which case None is specified as the</span>
<span class="sd">            owner.  If no owner is provided, then the supplied DBT (dbt) is</span>
<span class="sd">            used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting hazard.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Hazard:</span>
<span class="sd">        The newly created hazard instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">haz</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_hazard</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">dbt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddHazardCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Hazards&quot;</span><span class="p">,</span> <span class="n">haz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">haz</span></div>

    
<div class="viewcode-block" id="MakeMicrogridDesignOption">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeMicrogridDesignOption">[docs]</a>
<span class="k">def</span> <span class="nf">MakeMicrogridDesignOption</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridDesignOption</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new microgrid design option, extracts any</span>
<span class="sd">    provided properties, loads it into its owner (mg), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid into which the new design option will be installed.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to the new design option.  Names of design options</span>
<span class="sd">        within a microgrid must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new design</span>
<span class="sd">            option.  This is typically used if one does not want the design</span>
<span class="sd">            option added to the microgrid as part of this call in which case</span>
<span class="sd">            None is specified as the owner.  If no owner is provided, then the</span>
<span class="sd">            supplied microgrid (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting design option.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.MicrogridDesignOption:</span>
<span class="sd">        The newly created microgrid design option instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mdo</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_microgrid_design_option</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddDesignOptionCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_DesignOptions&quot;</span><span class="p">,</span> <span class="n">mdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">mdo</span></div>


<div class="viewcode-block" id="MakeBusDesignOption">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeBusDesignOption">[docs]</a>
<span class="k">def</span> <span class="nf">MakeBusDesignOption</span><span class="p">(</span><span class="n">mdo</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridDesignOption</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Bus</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">BusDesignOption</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new bus design option, extracts any</span>
<span class="sd">    provided properties, loads it into its owner (mdo), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mdo: MDT.MicrogridDesignOption</span>
<span class="sd">        The microgrid design option into which the new bus design option will be</span>
<span class="sd">        installed.  If an mdo is not provided (None), then an orphan bus design</span>
<span class="sd">        option is returned and should be added to an mdo at some later point.</span>
<span class="sd">    b: MDT.Bus</span>
<span class="sd">        The bus for which this bus design option is being built.  If this option</span>
<span class="sd">        is being built for a bus that is not part of the microgrid but instead</span>
<span class="sd">        should be added as part of the mdo, then this argument should be None.</span>
<span class="sd">        In that case, a new bus will be built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to the new bus design option.  Names of bus design</span>
<span class="sd">        options within a microgrid design option must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new bus design</span>
<span class="sd">            option.  This is typically used if one does not want the bus design</span>
<span class="sd">            option added to the microgrid design option as part of this call in</span>
<span class="sd">            which case None is specified as the owner.  If no owner is provided,</span>
<span class="sd">            then the supplied microgrid design option (mdo) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting bus design option.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.BusDesignOption:</span>
<span class="sd">        The newly created bus design option instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bdo</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_bus_design_option</span><span class="p">(</span><span class="n">mdo</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddBusDesignOptionCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_BusOptions&quot;</span><span class="p">,</span> <span class="n">bdo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">bdo</span></div>


<div class="viewcode-block" id="MakeLoadTier">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeLoadTier">[docs]</a>
<span class="k">def</span> <span class="nf">MakeLoadTier</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">LoadTier</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new load tier, extracts any</span>
<span class="sd">    provided properties, loads it into the master list, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to the new load tier.  Names of load tiers</span>
<span class="sd">        must be unique in the master list.</span>
<span class="sd">    priority: int</span>
<span class="sd">        The priority to be assigned to this new load tier.  The lower the value</span>
<span class="sd">        the higher the importance.  Negative numbers are not allowed.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new load tier.</span>
<span class="sd">            This is typically used if one does not want the load tier added to</span>
<span class="sd">            the driver as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the global Driver is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting load tier.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.LoadTier:</span>
<span class="sd">        The newly created load tier instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lt</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_load_tier</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddLoadTierCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_LoadTiers&quot;</span><span class="p">,</span> <span class="n">lt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">lt</span></div>


<div class="viewcode-block" id="MakeMicrogridNodeGroup">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeMicrogridNodeGroup">[docs]</a>
<span class="k">def</span> <span class="nf">MakeMicrogridNodeGroup</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridNodeGroup</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new microgrid node group, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which this node group is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this node group.  Names of node groups within a</span>
<span class="sd">        microgrid must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new group.  This</span>
<span class="sd">            is typically used if one does not want the group added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting node group.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Bus:</span>
<span class="sd">        The newly created node group instance.       </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_microgrid_node_group</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddNodeGroupCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_NodeGroups&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span></div>

        
<div class="viewcode-block" id="MakeSiteNodeGroup">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.MakeSiteNodeGroup">[docs]</a>
<span class="k">def</span> <span class="nf">MakeSiteNodeGroup</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Site</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SiteNodeGroup</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function creates a new site node group, extracts any</span>
<span class="sd">    provided properties, loads it into its owner, and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s: MDT.Site</span>
<span class="sd">        The site for which this node group is being built.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name to be given to this node group.  Names of node groups within a</span>
<span class="sd">        site must be unique.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new group. This</span>
<span class="sd">            is typically used if one does not want the group added to the site</span>
<span class="sd">            as part of this call in which case None is specified as the owner.</span>
<span class="sd">            If no owner is provided, then the supplied site (s) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes: str</span>
<span class="sd">            Any notes to assign to the resulting node group.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.Bus:</span>
<span class="sd">        The newly created node group instance.       </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_site_node_group</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddNodeGroupCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_NodeGroups&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span></div>

        
<div class="viewcode-block" id="SetDieselInfiniteFuel">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.SetDieselInfiniteFuel">[docs]</a>
<span class="k">def</span> <span class="nf">SetDieselInfiniteFuel</span><span class="p">(</span><span class="n">tank</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">DieselTank</span><span class="p">,</span> <span class="n">infinite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Assigns infinite fuel to the supplied tank or not depending on the value</span>
<span class="sd">    of the infinite parameter.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tank: MDT.DieselTank</span>
<span class="sd">        The tank to assign to have infinite fuel capacity or not.</span>
<span class="sd">    infinite: bool</span>
<span class="sd">        Whether or not the supplied tank should have infinite fuel capacity.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">tank</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_indexed_property_set_with_undo</span><span class="p">(</span>
        <span class="n">mgSets</span><span class="p">,</span> <span class="s2">&quot;UseInfiniteDieselFuel&quot;</span><span class="p">,</span> <span class="n">tank</span><span class="p">,</span> <span class="n">infinite</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="SetPropaneInfiniteFuel">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.SetPropaneInfiniteFuel">[docs]</a>
<span class="k">def</span> <span class="nf">SetPropaneInfiniteFuel</span><span class="p">(</span><span class="n">tank</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PropaneTank</span><span class="p">,</span> <span class="n">infinite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Assigns infinite fuel to the supplied tank or not depending on the value</span>
<span class="sd">    of the infinite parameter.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tank: MDT.PropaneTank</span>
<span class="sd">        The tank to assign to have infinite fuel capacity or not.</span>
<span class="sd">    infinite: bool</span>
<span class="sd">        Whether or not the supplied tank should have infinite fuel capacity.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">tank</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_indexed_property_set_with_undo</span><span class="p">(</span>
        <span class="n">mgSets</span><span class="p">,</span> <span class="s2">&quot;UseInfinitePropaneFuel&quot;</span><span class="p">,</span> <span class="n">tank</span><span class="p">,</span> <span class="n">infinite</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ResetRegularPeriodData">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ResetRegularPeriodData">[docs]</a>
<span class="k">def</span> <span class="nf">ResetRegularPeriodData</span><span class="p">(</span><span class="n">rpd</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">IRegularPeriodData</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Assigns the data in the supplied data set (data) to the supplied regular</span>
<span class="sd">    period data instance.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rpd: MDT.IRegularPeriodData</span>
<span class="sd">        The MDT data structure to load using the items in the second argument.</span>
<span class="sd">    data: iterable</span>
<span class="sd">        A collection of the values that should be pushed into the MDT data</span>
<span class="sd">        construct.  The items in this list must be float or convertible to</span>
<span class="sd">        float.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            A Log object into which to capture any messages generated during</span>
<span class="sd">            this operation.  If not provided, messages will be added into</span>
<span class="sd">            the pymdt.GlobalErrorLog.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">Common</span><span class="o">.</span><span class="n">Databinding</span><span class="o">.</span><span class="n">ObservableBindingListWithUndo</span><span class="p">[</span><span class="nb">float</span><span class="p">]()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_is_collection</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span> <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">dat</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">rpd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">rpd</span><span class="p">,</span> <span class="s2">&quot;LoadDataList&quot;</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>

    
<div class="viewcode-block" id="ConfigureMicrogridController">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ConfigureMicrogridController">[docs]</a>
<span class="k">def</span> <span class="nf">ConfigureMicrogridController</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sets the type and properties of the controller that controls islanded</span>
<span class="sd">    microgrid operations (as opposed to startup or grid-tied behavior.)</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which the microgrid controller is to be configured.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        controller_type:</span>
<span class="sd">            An optional parameter that indicates what type of controller to</span>
<span class="sd">            use.  This is one of the controller_types enumeration members.</span>
<span class="sd">            If no controller_type is provided, then the default is standard.</span>
<span class="sd">        gen_restart_delay: float</span>
<span class="sd">            The number of seconds of delay if a generator fails to start and</span>
<span class="sd">            further attempts should be made.  This is the time between attempts.</span>
<span class="sd">            The default is 15 seconds.</span>
<span class="sd">        bus_sync_delay: float</span>
<span class="sd">            The number of seconds required to synchronize two busses that are to</span>
<span class="sd">            be connected together.  The default is 20 seconds.</span>
<span class="sd">        gen_sync_delay: float</span>
<span class="sd">            The number of seconds required to synchronize a generator onto an</span>
<span class="sd">            already powered bus.  The default is 15 seconds.</span>
<span class="sd">        min_power_dispatch_threshold: float</span>
<span class="sd">            The fraction of load to current online generator below which a</span>
<span class="sd">            re-dispatch should be attempted.  A re-dispatch in this case may</span>
<span class="sd">            choose to shut some generation down.  The default is 0.4 (40%).</span>
<span class="sd">        forecast_duration: float</span>
<span class="sd">            The number of hours over which to do load, solar, etc. forecasting</span>
<span class="sd">            for the purposes of generator dispatch.  The default is 1 hour.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
    <span class="n">mgCSets</span> <span class="o">=</span> <span class="n">mgSets</span><span class="o">.</span><span class="n">MicrogridControllerSettings</span>
    
    <span class="k">if</span> <span class="s2">&quot;controller_type&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">mgCSets</span><span class="p">,</span> <span class="s2">&quot;ControllerType&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;controller_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;gen_restart_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">mgCSets</span><span class="p">,</span> <span class="s2">&quot;GeneratorRestartDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;gen_restart_delay&quot;</span><span class="p">],</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;bus_sync_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">mgCSets</span><span class="p">,</span> <span class="s2">&quot;BusSyncDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bus_sync_delay&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;gen_sync_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">mgCSets</span><span class="p">,</span> <span class="s2">&quot;GeneratorSyncDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;gen_sync_delay&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;min_power_dispatch_threshold&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">mgCSets</span><span class="p">,</span> <span class="s2">&quot;MinimumPowerDispatchThreshold&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;min_power_dispatch_threshold&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;forecast_duration&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">mgCSets</span><span class="p">,</span> <span class="s2">&quot;ForecastDuration&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;forecast_duration&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>

    
<div class="viewcode-block" id="ConfigureStartupController">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ConfigureStartupController">[docs]</a>
<span class="k">def</span> <span class="nf">ConfigureStartupController</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sets the type and properties of the controller that controls the startup</span>
<span class="sd">    of islanded microgrid operations (as opposed to the established microgrid or</span>
<span class="sd">    grid-tied behavior.)</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid for which the startup controller is to be configured.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        gen_restart_delay: float</span>
<span class="sd">            The number of seconds of delay if a generator fails to start and</span>
<span class="sd">            further attempts should be made.  This is the time between attempts.</span>
<span class="sd">            The default is 15 seconds.</span>
<span class="sd">        bus_sync_delay: float</span>
<span class="sd">            The number of seconds required to synchronize two busses that are to</span>
<span class="sd">            be connected together.  The default is 20 seconds.</span>
<span class="sd">        gen_sync_delay: float</span>
<span class="sd">            The number of seconds required to synchronize a generator onto an</span>
<span class="sd">            already powered bus.  The default is 15 seconds.</span>
<span class="sd">        gen_failed_formation_delay: float</span>
<span class="sd">            The number of seconds between the onset of a DBT occurrence and the</span>
<span class="sd">            formation of a microgrid if some backup generators failed to start.</span>
<span class="sd">            With a start failure, some critical load may be at risk and so it</span>
<span class="sd">            may be desirable to start networking generators with less delay.</span>
<span class="sd">            The default is 120 seconds.</span>
<span class="sd">        no_gen_failed_formation_delay: float</span>
<span class="sd">            The number of seconds between the onset of a DBT occurrence and the</span>
<span class="sd">            formation of a microgrid if all backup generators started properly.</span>
<span class="sd">            This allows a ride-through for short duration DBTs. The default is</span>
<span class="sd">            600 seconds.</span>
<span class="sd">        renewable_start_delay: float</span>
<span class="sd">            The number of seconds of delay between the end of the startup</span>
<span class="sd">            procedure and the reconnection of any non-ride-through inverter</span>
<span class="sd">            controlled renewable assets.  The default is 300 seconds.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
    <span class="n">stCSets</span> <span class="o">=</span> <span class="n">mgSets</span><span class="o">.</span><span class="n">StartupControllerSettings</span>
    
    <span class="k">if</span> <span class="s2">&quot;gen_restart_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stCSets</span><span class="p">,</span> <span class="s2">&quot;GeneratorRestartDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;gen_restart_delay&quot;</span><span class="p">],</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;gen_sync_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stCSets</span><span class="p">,</span> <span class="s2">&quot;GeneratorSyncDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;gen_sync_delay&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;bus_sync_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stCSets</span><span class="p">,</span> <span class="s2">&quot;BusSyncDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bus_sync_delay&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;gen_failed_formation_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stCSets</span><span class="p">,</span> <span class="s2">&quot;GeneratorFailedGridFormationDelay&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;gen_failed_formation_delay&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="k">if</span> <span class="s2">&quot;no_gen_failed_formation_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stCSets</span><span class="p">,</span> <span class="s2">&quot;NoGeneratorFailedGridFormationDelay&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;no_gen_failed_formation_delay&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    
    <span class="k">if</span> <span class="s2">&quot;renewable_start_delay&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">stCSets</span><span class="p">,</span> <span class="s2">&quot;RenewablesStartDelay&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;renewable_start_delay&quot;</span><span class="p">],</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>

    
<div class="viewcode-block" id="ConfigureGridTiedController">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ConfigureGridTiedController">[docs]</a>
<span class="k">def</span> <span class="nf">ConfigureGridTiedController</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function sets the properties of the controller that manages</span>
<span class="sd">    activities in the periods between DBT occurrences.</span>
<span class="sd">        </span>
<span class="sd">    The parameters all have to do with the tracking of failures and repairs</span>
<span class="sd">    during the grid-tied operation phase of the simulation.  A couple things to</span>
<span class="sd">    note are:</span>

<span class="sd">    1 - Even if tracking, statistics for failures and repairs are not kept</span>
<span class="sd">        during this phase.  The only real effect of doing so is that it is</span>
<span class="sd">        possible (or more possible) for an asset to be broken at the start</span>
<span class="sd">        of the next DBT.</span>
<span class="sd">    2 - Even if not tracking, a repair for an asset that failed during the</span>
<span class="sd">        DBT still may occur during the grid tied period and the full time</span>
<span class="sd">        of the repair will be tallied in statistics.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid instance for which the grid-tied controller is being</span>
<span class="sd">        configured.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        track_line_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of lines during the</span>
<span class="sd">            grid-tied operations.</span>
<span class="sd">        track_transformer_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of transformers</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_switch_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of switches</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_ups_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of UPSs</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_battery_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of Batteries</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_wind_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of Wind generators</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_hydro_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of Hydro generators</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_solar_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of Solar generators</span>
<span class="sd">            during the grid-tied operations.</span>
<span class="sd">        track_inverter_failures: bool</span>
<span class="sd">            Whether or not to execute failures and repairs of inverters during</span>
<span class="sd">            the grid-tied operations.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
    <span class="n">gtCSets</span> <span class="o">=</span> <span class="n">mgSets</span><span class="o">.</span><span class="n">GridTiedControllerSettings</span>
    <span class="n">defVal</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">GridTiedControllerSettings</span><span class="o">.</span><span class="n">DefaultTrackingStatus</span>
    
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackLineFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_line_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackTransformerFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_transformer_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackSwitchFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_switch_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackUPSFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_ups_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackBatteryFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_battery_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackWindGeneratorFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_wind_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackHydroGeneratorFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_hydro_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackSolarGeneratorFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_solar_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">gtCSets</span><span class="p">,</span> <span class="s2">&quot;TrackInverterFailures&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;track_inverter_failures&quot;</span><span class="p">,</span> <span class="n">defVal</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ConfigureDieselRefueller">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ConfigureDieselRefueller">[docs]</a>
<span class="k">def</span> <span class="nf">ConfigureDieselRefueller</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function sets the properties of the diesel refueling</span>
<span class="sd">    schedule.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid instance for which the diesel refueller is being</span>
<span class="sd">        configured.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        time_of_day: float</span>
<span class="sd">            The hour of day at which the first refuel action takes place.  A</span>
<span class="sd">            real valued number of hours from midnight [0-24].</span>
<span class="sd">        period: float</span>
<span class="sd">            The amount of time in hours between refuellings.</span>
<span class="sd">        quantity: float</span>
<span class="sd">            The maximum amount of fuel that can be delivered in any refuelling</span>
<span class="sd">            action.  A value of -1 allows for the delivery of any amount of fuel</span>
<span class="sd">            (infinite).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
    <span class="n">rfSets</span> <span class="o">=</span> <span class="n">mgSets</span><span class="o">.</span><span class="n">DieselRefuelingStrategySettings</span>
    <span class="n">details</span><span class="o">.</span><span class="n">_extract_refueler_settings</span><span class="p">(</span><span class="n">rfSets</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="ConfigurePropaneRefueller">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ConfigurePropaneRefueller">[docs]</a>
<span class="k">def</span> <span class="nf">ConfigurePropaneRefueller</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function sets the properties of the propane refueling</span>
<span class="sd">    schedule.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid instance for which the propane refueller is being</span>
<span class="sd">        configured.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        time_of_day: float</span>
<span class="sd">            The hour of day at which the first refuel action takes place.  A</span>
<span class="sd">            real valued number of hours from midnight [0-24].</span>
<span class="sd">        period: float</span>
<span class="sd">            The amount of time in hours between refuellings.</span>
<span class="sd">        quantity: float</span>
<span class="sd">            The maximum amount of fuel that can be delivered in any refuelling</span>
<span class="sd">            action.  A value of -1 allows for the delivery of any amount of fuel</span>
<span class="sd">            (infinite).</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mgSets</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_microgrid_settings</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
    <span class="n">rfSets</span> <span class="o">=</span> <span class="n">mgSets</span><span class="o">.</span><span class="n">PropaneRefuelingStrategySettings</span>
    <span class="n">details</span><span class="o">.</span><span class="n">_extract_refueler_settings</span><span class="p">(</span><span class="n">rfSets</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="ExtractPRMSettings">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ExtractPRMSettings">[docs]</a>
<span class="k">def</span> <span class="nf">ExtractPRMSettings</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRMSettings</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; A helper method to extract and return the MDT.PRMSettings object.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MDT.PRMSettings:</span>
<span class="sd">        The settings object that controls the operation of the PRM simulation</span>
<span class="sd">        that evaluates the function of microgrid configurations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">details</span><span class="o">.</span><span class="n">_extract_prm_settings</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">RunMDTGUI</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Executes the MDT GUI.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename: str</span>
<span class="sd">        An MDT input or output file to be opened in the MDT GUI if desired.  If</span>
<span class="sd">        not provided, the MDT is opened with no current file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    subprocess.CompletedProcess:</span>
<span class="sd">        The CompletedProcess object that results from a call to subprocess.run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
       <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pymdt</span><span class="o">.</span><span class="n">MDT_BIN_DIR</span><span class="p">,</span> <span class="s2">&quot;MDT-GUI.exe&quot;</span><span class="p">),</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">]</span>
       <span class="p">)</span>

<div class="viewcode-block" id="ConfigurePRM">
<a class="viewcode-back" href="../../pymdt.html#pymdt.core.ConfigurePRM">[docs]</a>
<span class="k">def</span> <span class="nf">ConfigurePRM</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This helper function sets the properties of the PRM simulation.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------    </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        simulation_years: float</span>
<span class="sd">            The total number of years of simulation to run for every</span>
<span class="sd">            configuration.  This includes both DBT or &quot;black sky&quot; time and</span>
<span class="sd">            normal operations (or &quot;blue sky) time.  The default is 1000 years.</span>
<span class="sd">        powerflow_type:</span>
<span class="sd">            The type of powerflow calculations to do. The only options are DC</span>
<span class="sd">            powerflow calculations and no (NONE) calculations.  These should be</span>
<span class="sd">            provided as members of the pymdt.core.powerflow_types enumeration.</span>
<span class="sd">            The default is NONE.</span>
<span class="sd">        use_reliability: bool</span>
<span class="sd">            Whether or not to include reliability calculations in the</span>
<span class="sd">            simulation.  This serves as a means of telling the simulation to</span>
<span class="sd">            ignore reliability inputs which can be useful for comparison trials.</span>
<span class="sd">            The default is True.</span>
<span class="sd">        use_fragility: bool</span>
<span class="sd">            Whether or not to include fragility calculations in the simulation.</span>
<span class="sd">            This serves as a means of telling the simulation to ignore fragility</span>
<span class="sd">            inputs which can be useful for comparison trials. The default is</span>
<span class="sd">            True.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new item.  If this argument is</span>
<span class="sd">            not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prmsets</span> <span class="o">=</span> <span class="n">ExtractPRMSettings</span><span class="p">()</span>

    <span class="k">if</span> <span class="s2">&quot;simulation_years&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">prmsets</span><span class="p">,</span> <span class="s2">&quot;SimulationYears&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;simulation_years&quot;</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="n">powerflow</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;powerflow_type&quot;</span><span class="p">,</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">powerflow_types</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">powerflow</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">):</span> <span class="n">powerflow</span> <span class="o">=</span> <span class="n">powerflow</span><span class="o">.</span><span class="n">value</span>
  
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">prmsets</span><span class="p">,</span> <span class="s2">&quot;PowerflowType&quot;</span><span class="p">,</span> <span class="n">powerflow</span>
        <span class="p">)</span>
    
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">prmsets</span><span class="p">,</span> <span class="s2">&quot;UseReliability&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_reliability&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>
    
    <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
        <span class="n">prmsets</span><span class="p">,</span> <span class="s2">&quot;UseFragility&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_fragility&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>