<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pymdt.metrics &#8212; sandia-pymdt 1.4.2520 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <script src="../../_static/documentation_options.js?v=b081cfe2"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pymdt.metrics</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="kn">import</span> <span class="nn">TMO</span>
<span class="kn">import</span> <span class="nn">MDT</span>
<span class="kn">import</span> <span class="nn">MDT.PRM</span>

<span class="kn">import</span> <span class="nn">pymdt.utils</span>
    
<div class="viewcode-block" id="improvement_types">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.improvement_types">[docs]</a>
<span class="k">class</span> <span class="nc">improvement_types</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An enumeration of the improvement types used for metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">minimize</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ImprovementType</span><span class="o">.</span><span class="n">MINIMIZE</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The metric is to be minimized (lower is better).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">maximize</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ImprovementType</span><span class="o">.</span><span class="n">MAXIMIZE</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The metric is to be maximized (higher is better).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">seek_value</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ImprovementType</span><span class="o">.</span><span class="n">SEEK_VALUE</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The specified value is sought (value is better).</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

    
<div class="viewcode-block" id="limit_stiffnesses">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.limit_stiffnesses">[docs]</a>
<span class="k">class</span> <span class="nc">limit_stiffnesses</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An enumeration of the stiffness indicator used for metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">minimize</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunction</span><span class="o">.</span><span class="n">StiffnessLevel</span><span class="o">.</span><span class="n">Soft</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The limit is such that violation is bad but not a really big deal.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">maximize</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunction</span><span class="o">.</span><span class="n">StiffnessLevel</span><span class="o">.</span><span class="n">Medium</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The limit is such that violation is bad and causes a significant</span>
<span class="sd">        detriment to fitness.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">seek_value</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunction</span><span class="o">.</span><span class="n">StiffnessLevel</span><span class="o">.</span><span class="n">Hard</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The limit is such that violation is very bad and causes a major</span>
<span class="sd">        detriment to fitness.  In addition, this limit is treated as a hard</span>
<span class="sd">        constraint by the optimizer such that its satisfaction is paramount when</span>
<span class="sd">        comparing solution quality amongst candidate solutions.        </span>
<span class="sd">    &quot;&quot;&quot;</span></div>

    
<div class="viewcode-block" id="value_beyond_objective">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.value_beyond_objective">[docs]</a>
<span class="k">class</span> <span class="nc">value_beyond_objective</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An enumeration of the value beyond objective indicator used for metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">low</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunction</span><span class="o">.</span><span class="n">ValueBeyondObjective</span><span class="o">.</span><span class="n">Low</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Indicates that the rate if diminishing returns is high and therefore</span>
<span class="sd">        the value of exceeding the objective is low.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">medium</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunction</span><span class="o">.</span><span class="n">ValueBeyondObjective</span><span class="o">.</span><span class="n">Medium</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Indicates that the rate if diminishing returns is moderate and therefore</span>
<span class="sd">        the value of exceeding the objective is moderate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">high</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunction</span><span class="o">.</span><span class="n">ValueBeyondObjective</span><span class="o">.</span><span class="n">High</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Indicates that the rate if diminishing returns is low and therefore</span>
<span class="sd">        the value of exceeding the objective is high.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="sim_phases">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.sim_phases">[docs]</a>
<span class="k">class</span> <span class="nc">sim_phases</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; An enumeration of the different phases of simulation over which metrics</span>
<span class="sd">    may be calculated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">post_startup</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridLoadConstraint</span><span class="o">.</span><span class="n">PHASE_ENUM</span><span class="o">.</span><span class="n">POST_STARTUP</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The period of simulation that begins when the startup phase ends and</span>
<span class="sd">    ends when the DBT ends.  This excludes the startup phase and any periods of</span>
<span class="sd">    grid-tied operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">startup</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridLoadConstraint</span><span class="o">.</span><span class="n">PHASE_ENUM</span><span class="o">.</span><span class="n">STARTUP</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The period of simulation that begins at the onset of the DBT and ends</span>
<span class="sd">    when the Microgrid is ready to begin networked operation.  This excludes</span>
<span class="sd">    the startup phase and any periods of grid-tied operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">overall</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridLoadConstraint</span><span class="o">.</span><span class="n">PHASE_ENUM</span><span class="o">.</span><span class="n">OVERALL</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The period of simulation that begins at the onset of the DBT and ends</span>
<span class="sd">    when the DBT ends.  This includes startup and microgrid operations phases</span>
<span class="sd">    but excludes any periods of grid-tied operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_a</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridLoadConstraint</span><span class="o">.</span><span class="n">PHASE_ENUM</span><span class="o">.</span><span class="n">N_A</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Used in limited circumstances when it is appropriate to indicate that</span>
<span class="sd">    a simulation phase need or should not be provided.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="details">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details">[docs]</a>
<span class="k">class</span> <span class="nc">details</span><span class="p">:</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_load_tier</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridLoadConstraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tier&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">FindEntityByName</span><span class="p">(</span><span class="n">MDT</span><span class="o">.</span><span class="n">Driver</span><span class="o">.</span><span class="n">INSTANCE</span><span class="o">.</span><span class="n">LoadTiers</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;LoadTier&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_sim_phase</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">MicrogridLoadConstraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">sim_phases</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">is</span> <span class="n">sim_phases</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">value</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;Phase&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_improvement_type</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">TMO</span><span class="o">.</span><span class="n">Constraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;improvement_type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="n">improvement_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="n">improvement_types</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;ImprovementType&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_limit_stiffness</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">TMO</span><span class="o">.</span><span class="n">Constraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;limit_stiffness&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="n">limit_stiffnesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="n">limit_stiffnesses</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;SingleValueLimitStiffness&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_value_beyond_objective</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">TMO</span><span class="o">.</span><span class="n">Constraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value_beyond_objective&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="n">value_beyond_objective</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">is</span> <span class="n">value_beyond_objective</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;SingleValueValueBeyondObjective&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_mission</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">SiteMissionConstraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">mn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mission&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;Mission&quot;</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">TMO</span><span class="o">.</span><span class="n">Constraint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;limit&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;SingleValueLimit&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">],</span>
                <span class="s2">&quot;ChangeSingleValueResponseDataCanceled&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;objective&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
                <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;SingleValueObjective&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;objective&quot;</span><span class="p">],</span>
                <span class="s2">&quot;ChangeSingleValueResponseDataCanceled&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_improvement_type</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_limit_stiffness</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_loggable_property_set_with_undo</span><span class="p">(</span>
            <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;SingleValueRelativeImportance&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;relative_importance&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="s2">&quot;ChangeSingleValueResponseDataCanceled&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_value_beyond_objective</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_set_def_imp_type</span><span class="p">(</span><span class="n">defType</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;improvement_type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;improvement_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defType</span>

<div class="viewcode-block" id="details.build_energy_availability_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_energy_availability_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_energy_availability_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">EnergyAvailabilityConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">EnergyAvailabilityConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_load_tier</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_sim_phase</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_average_energy_supplied_by_renewables_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_average_energy_supplied_by_renewables_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_average_energy_supplied_by_renewables_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageEnergySuppliedByRenewables</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageEnergySuppliedByRenewables</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_average_renewable_energy_spilled_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_average_renewable_energy_spilled_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_average_renewable_energy_spilled_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageRenewableEnergySpilledConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minmize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageRenewableEnergySpilledConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_average_renewable_penetration_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_average_renewable_penetration_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_average_renewable_penetration_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageRenewablePenetrationConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageRenewablePenetrationConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_average_spinning_reserve_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_average_spinning_reserve_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_average_spinning_reserve_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageSpinningReserveConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageSpinningReserveConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_diesel_efficiency_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_diesel_efficiency_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_diesel_efficiency_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselEfficiencyConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselEfficiencyConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_diesel_fuel_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_diesel_fuel_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_diesel_fuel_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselFuelConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselFuelConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_diesel_fuel_cost_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_diesel_fuel_cost_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_diesel_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselFuelCostConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselFuelCostConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_diesel_utilization_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_diesel_utilization_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_diesel_utilization_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselUtilizationConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselUtilizationConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_fossil_off_time_percentage_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_fossil_off_time_percentage_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_fossil_off_time_percentage_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">FossilOffTimePercentageConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">FossilOffTimePercentageConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_frequency_of_load_not_served_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_frequency_of_load_not_served_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_frequency_of_load_not_served_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">FreqOfLNSConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">FreqOfLNSConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_load_tier</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_sim_phase</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_heat_recovery_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_heat_recovery_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_heat_recovery_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">HeatRecoveryConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">HeatRecoveryConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_magnitude_of_load_not_served_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_magnitude_of_load_not_served_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_magnitude_of_load_not_served_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">MagOfLNSConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">MagOfLNSConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_load_tier</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_sim_phase</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_maximum_mission_outage_duration_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_maximum_mission_outage_duration_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_maximum_mission_outage_duration_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">MaximumMissionOutageDurationConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">MaximumMissionOutageDurationConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_mission</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_natural_gas_efficiency_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_natural_gas_efficiency_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_natural_gas_efficiency_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasEfficiencyConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasEfficiencyConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_natural_gas_fuel_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_natural_gas_fuel_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_natural_gas_fuel_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasFuelConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasFuelConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_natural_gas_fuel_cost_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_natural_gas_fuel_cost_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_natural_gas_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasFuelCostConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasFuelCostConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_natural_gas_utilization_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_natural_gas_utilization_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_natural_gas_utilization_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasUtilizationConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasUtilizationConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_propane_efficiency_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_propane_efficiency_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_propane_efficiency_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneEfficiencyConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneEfficiencyConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_propane_fuel_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_propane_fuel_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_propane_fuel_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneFuelConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneFuelConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_propane_fuel_cost_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_propane_fuel_cost_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_propane_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneFuelCostConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneFuelCostConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_propane_utilization_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_propane_utilization_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_propane_utilization_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneUtilizationConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneUtilizationConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_total_fuel_cost_metric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_total_fuel_cost_metric">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_total_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">TotalFuelCostConstraint</span><span class="p">:</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_set_def_imp_type</span><span class="p">(</span><span class="n">improvement_types</span><span class="o">.</span><span class="n">minimize</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">TotalFuelCostConstraint</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">_extract_metric_params</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span></div>

    
<div class="viewcode-block" id="details.build_response_function_group">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.details.build_response_function_group">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build_response_function_group</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunctionGroup</span><span class="p">:</span>
        <span class="n">rfg</span> <span class="o">=</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunctionGroup</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_guid</span><span class="p">(</span><span class="n">rfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">metrics</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_is_collection</span><span class="p">(</span><span class="n">metrics</span><span class="p">):</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
                    <span class="n">rfg</span><span class="p">,</span> <span class="s2">&quot;AddResponseFunctionCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_ResponseFunctions&quot;</span><span class="p">,</span>
                    <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                    <span class="p">)</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_notes</span><span class="p">(</span><span class="n">rfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rfg</span></div>
</div>

    
<div class="viewcode-block" id="MakeEnergyAvailabilityMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeEnergyAvailabilityMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeEnergyAvailabilityMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">EnergyAvailabilityConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.EnergyAvailabilityConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created metric.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        phase: pymdt.metrics.sim_phases</span>
<span class="sd">            This parameter should be a member of the pymdt.metrics.sim_phases</span>
<span class="sd">            enumeration.  This indicates what phase of the simulation the new</span>
<span class="sd">            metric should be applied to.  See the enumeration for details.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_energy_availability_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeAverageEnergySuppliedByRenewablesMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeAverageEnergySuppliedByRenewablesMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeAverageEnergySuppliedByRenewablesMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageEnergySuppliedByRenewables</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.AverageEnergySuppliedByRenewables class,</span>
<span class="sd">        loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_average_energy_supplied_by_renewables_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeAverageRenewableEnergySpilledMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeAverageRenewableEnergySpilledMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeAverageRenewableEnergySpilledMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageRenewableEnergySpilledConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.AverageRenewableEnergySpilledConstraint</span>
<span class="sd">        class, loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_average_renewable_energy_spilled_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeAverageRenewablePenetrationMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeAverageRenewablePenetrationMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeAverageRenewablePenetrationMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageRenewablePenetrationConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.AverageRenewablePenetrationConstraint</span>
<span class="sd">        class, loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_average_renewable_penetration_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeAverageSpinningReserveMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeAverageSpinningReserveMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeAverageSpinningReserveMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">AverageSpinningReserveConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.AverageSpinningReserveConstraint class,</span>
<span class="sd">        loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_average_spinning_reserve_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeDieselEfficiencyMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeDieselEfficiencyMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDieselEfficiencyMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselEfficiencyConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.DieselEfficiencyConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_diesel_efficiency_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeDieselFuelMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeDieselFuelMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDieselFuelMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselFuelConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.DieselFuelConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_diesel_fuel_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeDieselFuelCostMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeDieselFuelCostMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDieselFuelCostMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselFuelCostConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.DieselFuelCostConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_diesel_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeDieselUtilizationRateMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeDieselUtilizationRateMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeDieselUtilizationRateMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">DieselUtilizationConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.DieselUtilizationConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_diesel_utilization_rate_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeFossilOffTimePercentageMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeFossilOffTimePercentageMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeFossilOffTimePercentageMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">FossilOffTimePercentageConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.FossilOffTimePercentageConstraint class,</span>
<span class="sd">        loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_fossil_off_time_percentage_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeFrequencyOfLoadNotServedMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeFrequencyOfLoadNotServedMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeFrequencyOfLoadNotServedMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">FreqOfLNSConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.FreqOfLNSConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created metric.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        phase: pymdt.metrics.sim_phases</span>
<span class="sd">            This parameter should be a member of the pymdt.metrics.sim_phases</span>
<span class="sd">            enumeration.  This indicates what phase of the simulation the new</span>
<span class="sd">            metric should be applied to.  See the enumeration for details.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_frequency_of_load_not_served_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeMagnitudeOfLoadNotServedMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeMagnitudeOfLoadNotServedMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeMagnitudeOfLoadNotServedMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">MagOfLNSConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.MagOfLNSConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        tier:</span>
<span class="sd">            The tier for this newly created metric.  This can be an</span>
<span class="sd">            MDT.LoadTier or the name of a tier in which case the actual load</span>
<span class="sd">            tier will be found in the master list and assigned.</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        phase: pymdt.metrics.sim_phases</span>
<span class="sd">            This parameter should be a member of the pymdt.metrics.sim_phases</span>
<span class="sd">            enumeration.  This indicates what phase of the simulation the new</span>
<span class="sd">            metric should be applied to.  See the enumeration for details.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_magnitude_of_load_not_served_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeHeatRecoveryMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeHeatRecoveryMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeHeatRecoveryMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">HeatRecoveryConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.HeatRecoveryConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_heat_recovery_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeMaximumMissionOutageDurationMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeMaximumMissionOutageDurationMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeMaximumMissionOutageDurationMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">MaximumMissionOutageDurationConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.MaximumMissionOutageDurationConstraint</span>
<span class="sd">        class, loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        mission: MDT.Mission</span>
<span class="sd">            The mission whose outage duration is to be tracked.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_maximum_mission_outage_duration_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeNaturalGasEfficiencyMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeNaturalGasEfficiencyMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeNaturalGasEfficiencyMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasEfficiencyConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.NaturalGasEfficiencyConstraint class,</span>
<span class="sd">        loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_natural_gas_efficiency_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeNaturalGasFuelMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeNaturalGasFuelMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeNaturalGasFuelMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasFuelConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.NaturalGasFuelConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_natural_gas_fuel_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeNaturalGasFuelCostMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeNaturalGasFuelCostMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeNaturalGasFuelCostMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasFuelCostConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.NaturalGasFuelCostConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_natural_gas_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeNaturalGasUtilizationRateMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeNaturalGasUtilizationRateMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeNaturalGasUtilizationRateMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">NaturalGasUtilizationConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.NaturalGasUtilizationConstraint class,</span>
<span class="sd">        loads its properties, adds it to the microgrid (if provided), and</span>
<span class="sd">        returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_natural_gas_utilization_rate_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakePropaneEfficiencyMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakePropaneEfficiencyMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakePropaneEfficiencyMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneEfficiencyConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.PropaneEfficiencyConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_propane_efficiency_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakePropaneFuelMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakePropaneFuelMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakePropaneFuelMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneFuelConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.PropaneFuelConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_propane_fuel_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakePropaneFuelCostMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakePropaneFuelCostMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakePropaneFuelCostMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneFuelCostConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.PropaneFuelCostConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_propane_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakePropaneUtilizationRateMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakePropaneUtilizationRateMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakePropaneUtilizationRateMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">PropaneUtilizationConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.PropaneUtilizationConstraint class, loads</span>
<span class="sd">        its properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is maximize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_propane_utilization_rate_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeTotalFuelCostMetric">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeTotalFuelCostMetric">[docs]</a>
<span class="k">def</span> <span class="nf">MakeTotalFuelCostMetric</span><span class="p">(</span><span class="n">mg</span><span class="p">:</span> <span class="n">MDT</span><span class="o">.</span><span class="n">Microgrid</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MDT</span><span class="o">.</span><span class="n">PRM</span><span class="o">.</span><span class="n">TotalFuelCostConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of the MDT.TotalFuelCostConstraint class, loads its</span>
<span class="sd">        properties, adds it to the microgrid (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mg: MDT.Microgrid</span>
<span class="sd">        The microgrid to which to add the new metric.  If this argument is None,</span>
<span class="sd">        then the metric is created and loaded but not added to any entities</span>
<span class="sd">        metric list.  That will have to happen later.        </span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        improvement_type: pymdt.metrics.improvement_types</span>
<span class="sd">            A member of the pymdt.metrics.improvement_types enumeration</span>
<span class="sd">            indicating the desired improvement direction of the new metric.  The</span>
<span class="sd">            default improvement type for this metric type is minimize.</span>
<span class="sd">        limit: float</span>
<span class="sd">            The worst acceptable value for this metric.  This defines the</span>
<span class="sd">            boundary between acceptable and not acceptable. This is required.</span>
<span class="sd">        objective: float</span>
<span class="sd">            The desired value for this metric.  This is a value that, if</span>
<span class="sd">            achieved, provides full satisfaction.  Achieving values better than</span>
<span class="sd">            the objective may still provide benefit but at a diminishing rate of</span>
<span class="sd">            return.  This is required.</span>
<span class="sd">        limit_stiffness: pymdt.metrics.limit_stiffnesses</span>
<span class="sd">            A member of the pymdt.metrics.limit_stiffnesses enumeration</span>
<span class="sd">            indicating the desired strength of the limit for the new metric.</span>
<span class="sd">            The default stiffness for this metric type is medium.</span>
<span class="sd">        relative_importance: float</span>
<span class="sd">            The desired weight of this metric in trade-offs that occur.  It is</span>
<span class="sd">            advised that you not use this parameter unless absolutely necessary.</span>
<span class="sd">            Instead, the limit and objective values should be the primary means</span>
<span class="sd">            by which a metric is valued.  Using the relative_importance may not</span>
<span class="sd">            provide the results expected.  The default value for this is 1.0.</span>
<span class="sd">        value_beyond_objective: pymdt.metrics.value_beyond_objective</span>
<span class="sd">            A member of the pymdt.metrics.value_beyond_objective enumeration,</span>
<span class="sd">            this parameter controls the rate of diminishing returns for</span>
<span class="sd">            exceeding (doing better than) the objective for a configuration.</span>
<span class="sd">            the lower the VBO, the faster the rate of diminishing returns.</span>
<span class="sd">            The default for this is medium.</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new metric.  This</span>
<span class="sd">            is typically used if one does not want the metric added to the</span>
<span class="sd">            microgrid as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied microgrid</span>
<span class="sd">            (mg) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_total_fuel_cost_metric</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">mg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddConstraintCanceled&quot;</span><span class="p">,</span> <span class="s2">&quot;get_Constraints&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="MakeResponseFunctionGroup">
<a class="viewcode-back" href="../../pymdt.html#pymdt.metrics.MakeResponseFunctionGroup">[docs]</a>
<span class="k">def</span> <span class="nf">MakeResponseFunctionGroup</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">TMO</span><span class="o">.</span><span class="n">SolverInterface</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TMO</span><span class="o">.</span><span class="n">ResponseFunctionGroup</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds an instance of a TMO.ResponseFunctionGroup class, loads its</span>
<span class="sd">        properties, adds it to the solver (if provided), and returns it.</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s: TMO.SolverInterface</span>
<span class="sd">        The solver to which to add the new group.  If this argument is None,</span>
<span class="sd">        then the group is created and loaded but not added to any solvers group</span>
<span class="sd">        list.  That will have to happen later.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name for the new response function group.  This must be unique</span>
<span class="sd">        within the supplied solver.</span>
<span class="sd">    metrics: collection of TMO.Constraint</span>
<span class="sd">        The list of metrics to be included in this group.  Additional metrics</span>
<span class="sd">        can be added directly to the group afterwards if desired.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">        A dictionary of all the variable arguments provided to this function.</span>
<span class="sd">        The arguments used by this method include:</span>
<span class="sd">        </span>
<span class="sd">        Properties</span>
<span class="sd">        ----------</span>
<span class="sd">        owner:</span>
<span class="sd">            An optional parameter to serve as the owner of the new group.  This</span>
<span class="sd">            is typically used if one does not want the group added to the</span>
<span class="sd">            solver as part of this call in which case None is specified as</span>
<span class="sd">            the owner.  If no owner is provided, then the supplied solver</span>
<span class="sd">            (s) is used.</span>
<span class="sd">        err_log: Common.Logging.Log</span>
<span class="sd">            The log into which to record any errors encountered during the</span>
<span class="sd">            building, loading, or saving of the new specification.  If this</span>
<span class="sd">            argument is not provided, messages will be recorded into the</span>
<span class="sd">            pymdt.GlobalErrorLog instance.</span>
<span class="sd">        undos: Common.Undoing.IUndoPack</span>
<span class="sd">            An optional undo pack into which to load the undoable objects</span>
<span class="sd">            generated during this operation (if any).</span>
<span class="sd">        notes:</span>
<span class="sd">            Any notes to assign to the resulting metric. Not required.</span>
<span class="sd">        guid:</span>
<span class="sd">            The unique identifier to use for this new asset.  This can be</span>
<span class="sd">            a string formatted as described in:</span>
<span class="sd">            https://learn.microsoft.com/en-us/dotnet/api/system.guid.-ctor?view=net-8.0#system-guid-ctor(system-string)</span>
<span class="sd">            or a System.Guid instance.  If not provided, a newly created,</span>
<span class="sd">            random Guid is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rfg</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">build_response_function_group</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">pymdt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_extract_owner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">owner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pymdt</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">_execute_1_arg_add_with_undo</span><span class="p">(</span>
            <span class="n">owner</span><span class="p">,</span> <span class="s2">&quot;AddResponseFunctionGroupCanceled&quot;</span><span class="p">,</span>
            <span class="s2">&quot;get_ResponseFunctionGroups&quot;</span><span class="p">,</span> <span class="n">rfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">rfg</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">sandia-pymdt</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">pymdt</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, John Eddy.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>